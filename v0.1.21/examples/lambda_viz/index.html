<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Empirical Kendall function and Archimedean&#39;s λ function. · Copulas.jl</title><meta name="title" content="Empirical Kendall function and Archimedean&#39;s λ function. · Copulas.jl"/><meta property="og:title" content="Empirical Kendall function and Archimedean&#39;s λ function. · Copulas.jl"/><meta property="twitter:title" content="Empirical Kendall function and Archimedean&#39;s λ function. · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/examples/lambda_viz/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/examples/lambda_viz/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/examples/lambda_viz/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Copulas.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Copulas.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><a class="tocitem" href="../../elliptical/generalities/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/generalities/">Archimedean Copulas</a></li><li><a class="tocitem" href="../../Liouville/">Liouville Copulas</a></li><li><a class="tocitem" href="../../empirical/generalities/">Empirical Copulas</a></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li></ul></li><li><span class="tocitem">Bestiary</span><ul><li><a class="tocitem" href="../../elliptical/available_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Archimedean Generators</a></li><li><a class="tocitem" href="../../empirical/available_models/">Empirical Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Empirical Kendall function and Archimedean&#39;s λ function.</a></li><li><a class="tocitem" href="../lossalae/">Loss-Alae fitting example.</a></li><li><a class="tocitem" href="../fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../ifm1/">Influence of the method of estimation</a></li><li><a class="tocitem" href="../turing/">Bayesian inference with <code>Turing.jl</code></a></li><li><a class="tocitem" href="../other_usecases/">Other known use cases.</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Empirical Kendall function and Archimedean&#39;s λ function.</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Empirical Kendall function and Archimedean&#39;s λ function.</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/examples/lambda_viz.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Empirical-Kendall-function-and-Archimedean&#39;s-λ-function."><a class="docs-heading-anchor" href="#Empirical-Kendall-function-and-Archimedean&#39;s-λ-function.">Empirical Kendall function and Archimedean&#39;s λ function.</a><a id="Empirical-Kendall-function-and-Archimedean&#39;s-λ-function.-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-Kendall-function-and-Archimedean&#39;s-λ-function." title="Permalink"></a></h1><p>The Kendall function is an important function in dependence structure analysis. The Kendall function associated with a <span>$d$</span>-variate copula <span>$C$</span> is defined by letting <span>$\bm U = \left(U_1,...,U_n\right) \sim C$</span> and setting:</p><p class="math-container">\[K(t) = \mathbb P \left( C(U_1,...,U_d) \le t \right),\]</p><p>From a computational point of view, we often do not access to true observations of the random vector <span>$\m U \sim C$</span> but rather only observations on the marginal scales. Fortunately, this is not an issue and we can estimate the <span>$K$</span> function directly through a sample duplication trick.  For that, suppose for the sake of the argument that we have a multivariate sample on marignal scales <span>$\left(X_{i,j}\right)_{i \in 1,...,d,\; j \in 1,...,n}$</span> with dependence structure <span>$C$</span>.  A standard way to approximate <span>$K$</span> is to compute first</p><p class="math-container">\[Z_j = \frac{1}{n-1} \sum_{k \neq j} \bm 1_{X_{i,j} &lt; X_{i,k} \forall i \in 1,...,d}.\]</p><p>Indeed, <span>$K$</span> can be approximated as the empirical distribution function of <span>$Z_1,...,Z_n$</span>.  Here is a sketch implementation (not optimized) of this concept:</p><pre><code class="language-julia hljs">struct KendallFunction{T}
    z::Vector{T}
    function KendallFunction(x)
    d,n = size(x)
    z = zeros(n)
    for i in 1:n
        for j in 1:n
            if j ≠ i
                z[i] += reduce(&amp;, x[:,j] .&lt; x[:,i])
            end
        end
    end
    z ./= (n-1)
    sort!(z) # unnecessary
    return  new{eltype(z)}(z)
    end
end
function (K::KendallFunction)(t)
    # Then the K function is simply the empirical cdf of the Z sample:
    return sum(K.z .≤ t)/length(K.z)
end</code></pre><p>Let us try it on a random example: </p><pre><code class="language-julia hljs">using Copulas, Distributions, Plots
X = SklarDist(ClaytonCopula(2,2.7),(Normal(),Pareto()))
x = rand(X,1000)
K = KendallFunction(x)
plot(u -&gt; K(u), xlims = (0,1), title=&quot;Empirical Kendall function&quot;)</code></pre><img src="c6f5deef.svg" alt="Example block output"/><p>One notable detail on the Kendall function is that is does <strong>not</strong> characterize the copula in all generality. On the other hand, for an Archimedean copula with generator ϕ, we have:</p><p class="math-container">\[K(t) = t - \phi&#39;\{\phi^{-1}(t)\} \phi^{-1}(t).\]</p><p>Due to this partical relationship, the Kendall function actually characterizes the generator of the archimedean copula. In fact, this relationship is generally expressed in term of a λ function defined as <span>$\lambda(t) = t - K(t),$</span> which, for archimedean copulas, writes <span>$\lambda(t) = \phi&#39;\{\phi^{-1}(t)\} \phi^{-1}(t)$</span>.</p><p>Common λ functions can be easily derived by hand for standard archimedean generators. For any archimedean generator in the package, however, it is even easier to let Julia do the derivation. </p><p>Let&#39;s try to compare the empirical λ function from our dataset to a few theoretical ones. For that, we setup parameters of the relevant generators to match the kendall τ of the dataset (because we can). We include for the record the independent and completely monotonous cases.</p><pre><code class="language-julia hljs">using Copulas: ϕ⁽¹⁾, ϕ⁻¹, τ⁻¹, ClaytonGenerator, GumbelGenerator
using StatsBase: corkendall
λ(G,t) = ϕ⁽¹⁾(G,ϕ⁻¹(G,t)) * ϕ⁻¹(G,t)
plot(u -&gt; u - K(u), xlims = (0,1), label=&quot;Empirical λ function&quot;)
κ = corkendall(x&#39;)[1,2] # empirical kendall tau
θ_cl = τ⁻¹(ClaytonGenerator,κ)
θ_gb = τ⁻¹(GumbelGenerator,κ)
plot!(u -&gt; λ(ClaytonGenerator(θ_cl),u), label=&quot;Clayton&quot;)
plot!(u -&gt; λ(GumbelGenerator(θ_gb),u), label=&quot;Gumbel&quot;)
plot!(u -&gt; 0, label=&quot;Comonotony&quot;)
plot!(u -&gt; u*log(u), label=&quot;Independence&quot;)</code></pre><img src="9935bf9e.svg" alt="Example block output"/><p>The variance of the empirical λ function is notable on this example. In particular, we note that the estimated parameter</p><pre><code class="language-julia hljs">θ_cl</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.861266557016477</code></pre><p>is not very far for the true <span>$2.7$</span> we used to generate the dataset. A few more things could be tried before closing up the analysis on a real dataset: </p><ul><li>Empirical validation of the archimedean property of the data, and then</li><li>Non-parametric estimation of the generator from the empirical Kendall function, or through other means.</li><li>Non-archimedean parametric models.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../transformations/">« Transformed Copulas</a><a class="docs-footer-nextpage" href="../lossalae/">Loss-Alae fitting example. »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Saturday 24 February 2024 07:51">Saturday 24 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
