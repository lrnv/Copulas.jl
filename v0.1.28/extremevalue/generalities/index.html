<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Extreme Value Copulas · Copulas.jl</title><meta name="title" content="Extreme Value Copulas · Copulas.jl"/><meta property="og:title" content="Extreme Value Copulas · Copulas.jl"/><meta property="twitter:title" content="Extreme Value Copulas · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/extremevalue/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/extremevalue/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/extremevalue/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Copulas.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Copulas.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><a class="tocitem" href="../../elliptical/generalities/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/generalities/">Archimedean Generators</a></li><li class="is-active"><a class="tocitem" href>Extreme Value Copulas</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Advanced-Concepts"><span>Advanced Concepts</span></a></li><li><a class="tocitem" href="#Simulation-of-Bivariate-Extreme-Value-Distributions"><span>Simulation of Bivariate Extreme Value Distributions</span></a></li></ul></li><li><a class="tocitem" href="../../empirical/generalities/">Empirical Copulas</a></li><li><a class="tocitem" href="../../Vines/">Vines Copulas</a></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li></ul></li><li><span class="tocitem">Bestiary</span><ul><li><a class="tocitem" href="../../elliptical/available_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Archimedean Generators</a></li><li><a class="tocitem" href="../available_models/">Extreme Values Copulas</a></li><li><a class="tocitem" href="../../empirical/available_models/">Empirical Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/lambda_viz/">Empirical Kendall function and Archimedean&#39;s λ function.</a></li><li><a class="tocitem" href="../../examples/lossalae/">Loss-Alae fitting example.</a></li><li><a class="tocitem" href="../../examples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../examples/ifm1/">Influence of the method of estimation</a></li><li><a class="tocitem" href="../../examples/turing/">Bayesian inference with <code>Turing.jl</code></a></li><li><a class="tocitem" href="../../examples/other_usecases/">Other known use cases.</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Extreme Value Copulas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Extreme Value Copulas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/extremevalue/generalities.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Extreme_theory"><a class="docs-heading-anchor" href="#Extreme_theory">Extreme Value Copulas</a><a id="Extreme_theory-1"></a><a class="docs-heading-anchor-permalink" href="#Extreme_theory" title="Permalink"></a></h1><p><em>Extreme value copulas</em> are fundamental in the study of rare and extreme events due to their ability to model dependency in situations of extreme risk. This package proposes a wide selection of bivariate extreme values copulas, while multivariate cases are not implemented yet. Feel free to open an issue and/or propose pull requests if you want an implementation of a multivariate case. </p><div class="admonition is-info"><header class="admonition-header">Only Bivariate</header><div class="admonition-body"><p>The implementation we propose here only deals with bivariate extreme value copulas. Multivariate cases are more tedious to implement, but not impossible: if you want to propose an implementation, we can provide guidance on how to merge it here, do not hesitate to reach us on github.</p></div></div><p>A bivariate extreme value copula [<a href="../../references/#gudendorf2010extreme">34</a>] <span>$C$</span> is a copula that has the following caracteristic property: </p><p class="math-container">\[C(u_1^t, u_2^t)=C(u_1,u_2)^t, t &gt; 0.\]</p><p>It can be represented through its stable tail dependence function <span>$\ell(\cdot)$</span>:</p><p class="math-container">\[C(u_1, u_2)=\exp\{-\ell(\log(u_1),\log(u_2))\},\]</p><p>or through a convex function <span>$A: [0,1] \to [1/2, 1]$</span> satisfying <span>$\max(t, t-1)\leq A(t) \leq 1,$</span> called its Pickands dependence function:</p><p class="math-container">\[C(u_1,u_2)=\exp\left\{\log(u_1u_2)A\left(\frac{\log(u_1)}{\log(u_1u_2)}\right)\right\},\]</p><p>In the context of bivariate extreme value copulas, the functions <span>$\ell$</span> and <span>$A$</span> are related as follows:</p><p class="math-container">\[\ell(u_1,u_2)=(u_1+u_2)A\left(\frac{u_1}{u_1+u_2}\right).\]</p><div class="admonition is-success"><header class="admonition-header">Only `A` is needed</header><div class="admonition-body"><p>In our implementation, it is sufficient to provide the Pickands dependence function <span>$A$</span> to construct the extreme value copula and have it work correctly. Providing the other functions would, of course, improve performances.</p></div></div><p>In this package, there is an abstract type <a href="#Copulas.ExtremeValueCopula"><code>ExtremeValueCopula</code></a> that provides a foundation for defining bivariate extreme value copulas. Many extreme value copulas are already implemented for you! See <a href="../available_models/#available_extreme_models">this list</a> to get an overview.</p><p>If you do not find the one you need, you may define it yourself by subtyping <code>ExtremeValueCopula</code>. The API does not require much information, which is really convenient. Only a method for the pickand function <code>A(C::ExtremeValueCopula) = ...</code> is required. By providing this functions, you can easily create a new extreme value copula that fits your specific needs:</p><pre><code class="language-julia hljs">struct MyExtremeValueCopula{P} &lt;: ExtremeValueCopula{P}
    θ::P
end

A(C::ExtremeValueCopula, t) = (t^C.θ + (1 - t)^C.θ)^(1/C.θ) # This is the Pickands function of the Logistic (Gumbel) Copula</code></pre><h1 id="Advanced-Concepts"><a class="docs-heading-anchor" href="#Advanced-Concepts">Advanced Concepts</a><a id="Advanced-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Concepts" title="Permalink"></a></h1><p>Here, we present some important concepts from the theory of extreme value copulas that are useful for the development of this package.</p><p>Let <span>$(X,Y) \sim C$</span> where <span>$C$</span> is a bivariate extreme value copula. We have the following result from [<a href="../../references/#ghoudi1998proprietes">35</a>]:</p><div class="admonition is-category-property"><header class="admonition-header">Property (Ghoudi 1998):</header><div class="admonition-body"><p>Let <span>$(X, Y) \sim C$</span>, where <span>$C$</span> is an extreme value copula. The joint distribution of <span>$X$</span> and <span>$Z = \frac{\log(X)}{\log(XY)}$</span> is given by:</p><p class="math-container">\[P(Z \leq z, X \leq x) =G(z,x)=\left(z + z(1-z)\frac{A&#39;(z)}{A(z)}\right)x^{A(z)/z}, \quad 0\leq x,z \leq 1\]</p><p>where <span>$A&#39;(z)$</span> denotes the derivate of function <span>$A(z)$</span> at point <span>$z.$</span></p></div></div><p>Since <span>$A$</span> is a convex function defined on <span>$[0, 1]$</span> and satisfies <span>$-1 \leq A&#39;(z) \leq 1$</span>, by extension, we define <span>$A&#39;(1)$</span> as the supremum of <span>$A&#39;(z)$</span> over <span>$(0, 1)$</span>. By setting <span>$x = 1$</span> in the previous result, we obtain the marginal distribution of <span>$Z$</span>: <span>$P(Z \leq z) = G_Z(z) = z + z(1 - z) \frac{A&#39;(z)}{A(z)}, \quad 0 \leq z \leq 1.$</span></p><p>This result was demonstrated by Deheuvels (1991) [<a href="../../references/#deheuvels1991limiting">36</a>] in the case where <span>$A$</span> admits a second derivative.</p><h2 id="Simulation-of-Bivariate-Extreme-Value-Distributions"><a class="docs-heading-anchor" href="#Simulation-of-Bivariate-Extreme-Value-Distributions">Simulation of Bivariate Extreme Value Distributions</a><a id="Simulation-of-Bivariate-Extreme-Value-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-Bivariate-Extreme-Value-Distributions" title="Permalink"></a></h2><p>To simulate a bivariate extreme value distribution <span>$C(x, y)$</span>, remark that if <span>$F_1$</span> and <span>$F_2$</span> are univariate extreme value distributions, then the pair <span>$( F_1^{-1}(X), F_2^{-1}(Y) )$</span> is distributed according to a bivariate extreme value distribution. The proposed algorithm in Ghoudi,1998, [<a href="../../references/#ghoudi1998proprietes">35</a>] allows simulating such a distribution.</p><p>Assume <span>$A$</span> has a second derivative, making the distribution absolutely continuous. In this case, <span>$Z$</span> is also absolutely continuous and has a density <span>$g_Z(z)$</span> given by:</p><p class="math-container">\[g_Z(z) = \frac{d}{dz} G_Z(z) = 1 + (1 - z)^{-1} \left(A(z) - z A&#39;(z)\right)\]</p><p>The conditional distribution of <span>$W$</span> given <span>$Z$</span> is:</p><p class="math-container">\[F(w|z) = \frac{1}{g_Z(z)} \frac{d}{dz} F(z, w),\]</p><p>which simplifies to:</p><p class="math-container">\[F(w|z) = w \frac{z(1 - z) A&#39;(z)}{A(z) g_Z(z)} + (w - w \log w) \left(1 - \frac{z(1 - z) A&#39;&#39;(z)}{A(z) g_Z(z)} \right)\]</p><p>Given <span>$Z$</span>, the distribution of <span>$W$</span> is uniform on <span>$(0, 1)$</span> with probability <span>$p(Z)$</span> and equals the product of two independent uniforms on <span>$(0, 1)$</span> with probability <span>$1 - p(Z)$</span>, where:</p><p class="math-container">\[p(z) = \frac{z(1 - z) A&#39;(z)}{A(z) g_Z(z)}\]</p><p>Since <span>$g_Z(z)$</span> is the derivative of the cumulative distribution function of <span>$Z$</span>, it holds that <span>$0 \leq p(z) \leq 1$</span>.</p><p>For the class of Extreme Value Copulas, We follow the methodology proposed by Ghoudi,1998. page 191. [<a href="../../references/#ghoudi1998proprietes">35</a>]. Here, is a detailed algorithm for sampling from bivariate Extreme Value Copulas:</p><div class="admonition is-category-algorithm"><header class="admonition-header">Algotithm (Bivariate Extreme Value Copulas sampling):</header><div class="admonition-body"><ul><li>Simulate <span>$U_1,U_2 \sim \mathcal{U}[0,1]$</span></li><li>Simulate <span>$Z \sim G_Z(z)$</span> </li><li>Select <span>$W=U_1$</span> with probability <span>$p(Z)$</span> and <span>$W=U_1U_2$</span> with probability <span>$1-p(Z)$</span></li><li>Return <span>$X=W^{Z/A(Z)}$</span> and <span>$Y=W^{(1-Z)/A(Z)}$</span>  </li></ul></div></div><p>Note that all functions present in the algorithm were previously defined in previous sections to ensure that the implemented methodology has a solid theoretical basis.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.ExtremeValueCopula" href="#Copulas.ExtremeValueCopula"><code>Copulas.ExtremeValueCopula</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExtremeValueCopula{P}</code></pre><p>Fields:     - P::Parameters: Parameters that define the copula.</p><p>Constructor:     ExtremeValueCopula(P)</p><p>Represents a bivariate extreme value copula parameterized by <code>P</code>. Extreme value copulas are used to model the dependence structure between two random variables in the tails of their distribution, making them particularly useful in risk management, environmental studies, and finance.</p><p>In the bivariate case, an extreme value copula can be expressed as:</p><p class="math-container">\[C(u, v) = \exp(-\ell(\log(u), \log(v))).\]</p><p>where <span>$\ell(\cdot)$</span> is a tail dependence function associated with the bivariate extreme value copula. Furthermore, <span>$A(t)$</span> is a function <span>$A: [0, 1] \to [0.5, 1]$</span> that is convex on the interval [0,1] and satisfies the boundary conditions <span>$A(0) = A(1) = 1$</span>. This is denominated Pickands representation or Pickands function.</p><p>It is possible to relate these functions in the following way</p><p class="math-container">\[\ell(u, v) = \frac{u}{u+v}A\left(\frac{u}{u+v}\right).\]</p><p>In this way, in order to define a bivariate copula of extreme values, it is only necessary to introduce the function <span>$A$</span>.</p><p>A generic bivariate Extreme Values copula can be constructed as follows:</p><pre><code class="language-julia hljs">struct GalambosCopula{P} &lt;: ExtremeValueCopula{P}
A(C::GalambosCopula, t::Real) = 1 - (t^(-C.θ) + (1 - t)^(-C.θ))^(-1/C.θ) # You can define your own Pickands representation
param = 2.5
C = GalambosCopula(param)</code></pre><p>The obtained model can be used as follows: </p><pre><code class="language-julia hljs">samples = rand(C,1000)   # sampling
cdf(C,samples)           # cdf
pdf(C,samples)           # pdf</code></pre><p>References:</p><ul><li>[<a href="../../references/#gudendorf2010extreme">34</a>] G., &amp; Segers, J. (2010). Extreme-value copulas. In Copula Theory and Its Applications (pp. 127-145). Springer.</li><li>[<a href="../../references/#joe2014">4</a>] Joe, H. (2014). Dependence Modeling with Copulas. CRC Press.</li><li>[<a href="../../references/#mai2014financial">37</a>] Mai, J. F., &amp; Scherer, M. (2014). Financial engineering with copulas explained (p. 168). London: Palgrave Macmillan.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/69ad41dd478c3b87d2f750cc3c49fa0d63c42e7e/src/ExtremeValueCopula.jl#L1-L51">source</a></section></article><div class="citation noncanonical"><dl><dt>[4]</dt><dd><div>H. Joe. <em>Dependence Modeling with Copulas</em> (CRC press, 2014).</div></dd><dt>[34]</dt><dd><div>G. Gudendorf and J. Segers. <em>Extreme-value copulas</em>. In: <em>Copula Theory and Its Applications: Proceedings of the Workshop Held in Warsaw, 25-26 September 2009</em> (Springer, 2010); pp. 127–145.</div></dd><dt>[35]</dt><dd><div>K. Ghoudi, A. Khoudraji and E. L.-P. Rivest. <em>Propriétés statistiques des copules de valeurs extrêmes bidimensionnelles</em>. Canadian Journal of Statistics <strong>26</strong>, 187–197 (1998).</div></dd><dt>[36]</dt><dd><div>P. Deheuvels. <em>On the limiting behavior of the Pickands estimator for bivariate extreme-value distributions</em>. Statistics &amp; Probability Letters <strong>12</strong>, 429–439 (1991).</div></dd><dt>[37]</dt><dd><div>J.-F. Mai and M. Scherer. <em>Financial engineering with copulas explained</em> (Springer, 2014).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../archimedean/generalities/">« Archimedean Generators</a><a class="docs-footer-nextpage" href="../../empirical/generalities/">Empirical Copulas »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 13 January 2025 12:25">Monday 13 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
