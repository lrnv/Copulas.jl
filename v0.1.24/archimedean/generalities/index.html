<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Archimedean Copulas ¬∑ Copulas.jl</title><meta name="title" content="Archimedean Copulas ¬∑ Copulas.jl"/><meta property="og:title" content="Archimedean Copulas ¬∑ Copulas.jl"/><meta property="twitter:title" content="Archimedean Copulas ¬∑ Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Copulas.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Copulas.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><a class="tocitem" href="../../elliptical/generalities/">Elliptical Copulas</a></li><li class="is-active"><a class="tocitem" href>Archimedean Copulas</a><ul class="internal"><li><a class="tocitem" href="#Generators-and-d-monotony"><span>Generators and d-monotony</span></a></li><li><a class="tocitem" href="#Williamson-d-transform"><span>Williamson d-transform</span></a></li><li><a class="tocitem" href="#w_trans_section"><span>Inverse Williamson d-transform</span></a></li><li><a class="tocitem" href="#Archimedean-copulas"><span>Archimedean copulas</span></a></li></ul></li><li><a class="tocitem" href="../../Liouville/">Liouville Copulas</a></li><li><a class="tocitem" href="../../extremevalue/generalities/">Extreme Value Copulas</a></li><li><a class="tocitem" href="../../empirical/generalities/">Empirical Copulas</a></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li></ul></li><li><span class="tocitem">Bestiary</span><ul><li><a class="tocitem" href="../../elliptical/available_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../available_models/">Archimedean Generators</a></li><li><a class="tocitem" href="../../extremevalue/available_models/">Extreme Values Copulas</a></li><li><a class="tocitem" href="../../empirical/available_models/">Empirical Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/lambda_viz/">Empirical Kendall function and Archimedean&#39;s Œª function.</a></li><li><a class="tocitem" href="../../examples/lossalae/">Loss-Alae fitting example.</a></li><li><a class="tocitem" href="../../examples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../examples/ifm1/">Influence of the method of estimation</a></li><li><a class="tocitem" href="../../examples/turing/">Bayesian inference with <code>Turing.jl</code></a></li><li><a class="tocitem" href="../../examples/other_usecases/">Other known use cases.</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Archimedean Copulas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Archimedean Copulas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/archimedean/generalities.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="archimedean_copulas_header"><a class="docs-heading-anchor" href="#archimedean_copulas_header">General Discussion</a><a id="archimedean_copulas_header-1"></a><a class="docs-heading-anchor-permalink" href="#archimedean_copulas_header" title="Permalink"></a></h1><p>An important parametric class of copulas is the class of Archimedean copulas. To define Archimedean copulas, we must take a look at their <em>generators</em>, which are unrelated to spherical generators, and must be <span>$d$</span>-monotone functions. </p><h2 id="Generators-and-d-monotony"><a class="docs-heading-anchor" href="#Generators-and-d-monotony">Generators and d-monotony</a><a id="Generators-and-d-monotony-1"></a><a class="docs-heading-anchor-permalink" href="#Generators-and-d-monotony" title="Permalink"></a></h2><p>Archimedean generators can be defined as follows:</p><blockquote><p><strong>Definition (Archimedean generator):</strong> A <span>$d$</span>-Archimedean generator is a <span>$d$</span>-monotone function </p><p class="math-container">\[\phi :\mathbb R_+ \to [0,1]\]</p><p>such that <span>$\phi(0) = 1$</span> and <span>$\phi(+\infty) = 0$</span>.</p></blockquote><p>where the notion of <span>$d$</span>-monotone function can be defined as follows: </p><blockquote><p><strong>Definition (d-monotony [<a href="../../references/#mcneil2009">20</a>]):</strong> A function <span>$\phi$</span> is said to be <span>$d$</span>-monotone if it has <span>$d-2$</span> derivatives which satisfy </p><p class="math-container">\[(-1)^k \phi^{(k)} \ge 0 \;\forall k \in \{1,..,d-2\},\]</p><p>and if <span>$(-1)^{d-2}\phi^{(d-2)}$</span> is a non-increasing and convex function. </p><p>A function that is <span>$d$</span>-monotone for all <span>$d$</span> is called <strong>completely monotone</strong>.</p></blockquote><p>In this package, there is an abstract class <a href="#Copulas.Generator"><code>Generator</code></a> that contains those generators. Many Archimedean generators are already implemented for you ! See <a href="../available_models/#available_archimedean_models">the list of implemented archimedean generator</a> to get an overview. </p><p>If you do not find the one you need, you may define it yourself by subtyping <code>Generator</code>. The API does not ask for much information, which is really convenient. Only the two following methods are required:</p><ul><li>The <code>œï(G::MyGenerator,t)</code> function returns the value of the archimedean generator itself. </li><li>The <code>max_monotony(G::MyGenerator)</code> returns its maximum monotony, that is the greater integer <span>$d$</span> making the generator <span>$d$</span>-monotonous.</li></ul><p>Thus, a new generator implementation may simply look like:</p><pre><code class="language-julia hljs">struct MyGenerator{T} &lt;: Generator
    Œ∏::T
end
œï(G::MyGenerator,t) = exp(-G.Œ∏ * t) # can you recognise this one ?
max_monotony(G::MyGenerator) = Inf</code></pre><div class="admonition is-success"><header class="admonition-header">Win-Win strategy</header><div class="admonition-body"><p>These two functions are enough to sample the corresponding Archimedean copula (see how in the <a href="#w_trans_section">Inverse Williamson <span>$d$</span>-transforms</a> section of the documentation). However, if you know a bit more about your generator, implementing a few more simple methods can largely fasten the algorithms. You&#39;ll find more details on these methods in the <a href="#Copulas.Generator"><code>Generator</code></a> docstring.</p></div></div><p>For example, Here is a graph of a few Clayton Generators: </p><pre><code class="language-julia hljs">using Copulas: œï,ClaytonGenerator,IndependentGenerator
using Plots
plot( x -&gt; œï(ClaytonGenerator(-0.5),x), xlims=(0,5), label=&quot;ClaytonGenerator(-0.5)&quot;)
plot!(x -&gt; œï(IndependentGenerator(),x), label=&quot;IndependentGenerator()&quot;)
plot!(x -&gt; œï(ClaytonGenerator(0.5),x), label=&quot;ClaytonGenerator(0.5)&quot;)
plot!(x -&gt; œï(ClaytonGenerator(1),x), label=&quot;ClaytonGenerator(1)&quot;)
plot!(x -&gt; œï(ClaytonGenerator(5),x), label=&quot;ClaytonGenerator(5)&quot;)</code></pre><img src="3c05a883.svg" alt="Example block output"/><p>And the corresponding inverse functions: </p><pre><code class="language-julia hljs">using Copulas: œï‚Åª¬π,ClaytonGenerator,IndependentGenerator
using Plots
plot( x -&gt; œï‚Åª¬π(ClaytonGenerator(-0.5),x), xlims=(0,1), ylims=(0,5), label=&quot;ClaytonGenerator(-0.5)&quot;)
plot!(x -&gt; œï‚Åª¬π(IndependentGenerator(),x), label=&quot;IndependentGenerator()&quot;)
plot!(x -&gt; œï‚Åª¬π(ClaytonGenerator(0.5),x), label=&quot;ClaytonGenerator(0.5)&quot;)
plot!(x -&gt; œï‚Åª¬π(ClaytonGenerator(1),x), label=&quot;ClaytonGenerator(1)&quot;)
plot!(x -&gt; œï‚Åª¬π(ClaytonGenerator(5),x), label=&quot;ClaytonGenerator(5)&quot;)</code></pre><img src="4b0cfd30.svg" alt="Example block output"/><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.Generator" href="#Copulas.Generator"><code>Copulas.Generator</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Generator</code></pre><p>Abstract type. Implements the API for archimedean generators. </p><p>An Archimedean generator is simply a function  <span>$\phi :\mathbb R_+ \to [0,1]$</span> such that <span>$\phi(0) = 1$</span> and <span>$\phi(+\infty) = 0$</span>. </p><p>To generate an archimedean copula in dimension <span>$d$</span>, the function also needs to be <span>$d$</span>-monotone, that is : </p><ul><li><span>$\phi$</span> is <span>$d-2$</span> times derivable.</li><li><span>$(-1)^k \phi^{(k)} \ge 0 \;\forall k \in \{1,..,d-2\},$</span> and if <span>$(-1)^{d-2}\phi^{(d-2)}$</span> is a non-increasing and convex function. </li></ul><p>The access to the function <span>$\phi$</span> itself is done through the interface: </p><pre><code class="nohighlight hljs">œï(G::Generator, t)</code></pre><p>We do not check algorithmically that the proposed generators are d-monotonous. Instead, it is up to the person implementing the generator to tell the interface how big can <span>$d$</span> be through the function </p><pre><code class="nohighlight hljs">max_monotony(G::MyGenerator) = # some integer, the maximum d so that the generator is d-monotonous.</code></pre><p>More methods can be implemented for performance, althouhg there are implement defaults in the package : </p><ul><li><code>œï‚Åª¬π( G::Generator, x)</code> gives the inverse function of the generator.</li><li><code>œï‚ÅΩ¬π‚Åæ(G::Generator, t)</code> gives the first derivative. </li><li><code>œï‚ÅΩ·µè‚Åæ(G::Generator, k, t)</code> gives the kth derivative. </li><li><code>williamson_dist(G::Generator, d)</code> gives the Wiliamson d-transform of the generator, see <a href="https://github.com/lrnv/WilliamsonTransforms.jl">WilliamsonTransforms.jl</a>.</li></ul><p>References: </p><ul><li>[<a href="../../references/#mcneil2009">20</a>] McNeil, A. J., &amp; Ne≈°lehov√°, J. (2009). Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/f77fd0dc78452dfb878a78a5f53e5dfc95f07a67/src/Generator.jl#L1-L32">source</a></section></article><p>Note that the rate at which these functions are reaching 0 (and their inverse reaching infinity on the left boundary) can vary a lot from one to the other. Note also that the difference between each of them is easier to grasp on the inverse plot. </p><h2 id="Williamson-d-transform"><a class="docs-heading-anchor" href="#Williamson-d-transform">Williamson d-transform</a><a id="Williamson-d-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Williamson-d-transform" title="Permalink"></a></h2><p>An easy way to construct new <span>$d$</span>-monotonous generators is the use of the Williamson <span>$d$</span>-transform.</p><blockquote><p><strong>Definition (Williamson d-transformation):</strong> For a univariate non-negative random variable <span>$X$</span>, with cumulative distribution function <span>$F$</span> and an integer <span>$d\ge 2$</span>, the Williamson-d-transform of <span>$X$</span> is the real function supported on <span>$[0,\infty[$</span> given by:</p><p class="math-container">\[\phi(t) = ùí≤_{d}(X)(t)\]</p><p class="math-container">\[=\int_{t}^{\infty} \left(1 - \frac{t}{x}\right)^{d-1} dF(x)\]</p><p class="math-container">\[= \mathbb E\left( (1 - \frac{t}{X})^{d-1}_+\right) \mathbb 1_{t &gt; 0} + \left(1 - F(0)\right)\mathbb 1_{t &lt;0}\]</p></blockquote><p>In this package, we implemented it through the <a href="../available_models/#WilliamsonGenerator"><code>WilliamsonGenerator</code></a> class. It can be used as follows: </p><p><code>WilliamsonGenerator(X::UnivariateRandomVariable, d)</code>.</p><p>This function computes the Williamson d-transform of the provided random variable <span>$X$</span> using the <a href="https://github.com/lrnv/WilliamsonTransforms.jl"><code>WilliamsonTransforms.jl</code></a> package. See [<a href="../../references/#mcneil2009">20</a>, <a href="../../references/#williamson1955multiply">21</a>] for the literature. </p><div class="admonition is-category-warn"><header class="admonition-header">`max_monotony` of Williamson generators</header><div class="admonition-body"><p>The <span>$d$</span>-transform of a positive random variable is <span>$d$</span>-monotonous but not <span>$k$</span>-monotonous for any <span>$k &gt; d$</span>. Its max monotony is therefore <span>$d$</span>. This has a few implications, one of the biggest one is that the <span>$d$</span>-variate Archimedean copula that corresponds has no density. </p><p>More genrally, if you want your Archimedean copula to have a density, you have to use a generator that is more-monotonous that the dimension of your model. </p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.WilliamsonGenerator" href="#Copulas.WilliamsonGenerator"><code>Copulas.WilliamsonGenerator</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WilliamsonGenerator{TX}
iùí≤{TX}</code></pre><p>Fields:</p><ul><li><code>X::TX</code> ‚Äì a random variable that represents its Williamson d-transform</li><li><code>d::Int</code> ‚Äì the dimension of the transformation. </li></ul><p>Constructor</p><pre><code class="nohighlight hljs">WilliamsonGenerator(X::Distributions.UnivariateDistribution, d)
iùí≤(X::Distributions.UnivariateDistribution,d)</code></pre><p>The <code>WilliamsonGenerator</code> (alias <code>iùí≤</code>) allows to construct a d-monotonous archimedean generator from a positive random variable <code>X::Distributions.UnivariateDistribution</code>. The transformation, which is called the inverse Williamson transformation, is implemented in <a href="https://www.github.com/lrnv/WilliamsonTransforms.jl">WilliamsonTransforms.jl</a>. </p><p>For a univariate non-negative random variable <span>$X$</span>, with cumulative distribution function <span>$F$</span> and an integer <span>$d\ge 2$</span>, the Williamson-d-transform of <span>$X$</span> is the real function supported on <span>$[0,\infty[$</span> given by:</p><p class="math-container">\[\phi(t) = ùí≤_{d}(X)(t) = \int_{t}^{\infty} \left(1 - \frac{t}{x}\right)^{d-1} dF(x) = \mathbb E\left( (1 - \frac{t}{X})^{d-1}_+\right) \mathbb 1_{t &gt; 0} + \left(1 - F(0)\right)\mathbb 1_{t &lt;0}\]</p><p>This function has several properties: </p><ul><li>We have that <span>$\phi(0) = 1$</span> and <span>$\phi(Inf) = 0$</span></li><li><span>$\phi$</span> is <span>$d-2$</span> times derivable, and the signs of its derivatives alternates : <span>$\forall k \in 0,...,d-2, (-1)^k \phi^{(k)} \ge 0$</span>.</li><li><span>$\phi^{(d-2)}$</span> is convex.</li></ul><p>These properties makes this function what is called a <em>d-monotone archimedean generator</em>, able to generate <em>archimedean copulas</em> in dimensions up to <span>$d$</span>. Our implementation provides this through the <code>Generator</code> interface: the function <span>$\phi$</span> can be accessed by </p><pre><code class="nohighlight hljs">G = WilliamsonGenerator(X, d)
œï(G,t)</code></pre><p>Note that you&#39;ll always have:</p><pre><code class="nohighlight hljs">max_monotony(WilliamsonGenerator(X,d)) === d</code></pre><p>References: </p><ul><li>[<a href="../../references/#williamson1955multiply">21</a>] Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581</li><li>[<a href="../../references/#mcneil2009">20</a>] McNeil, Alexander J., and Johanna Ne≈°lehov√°. &quot;Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.&quot; (2009): 3059-3097.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/f77fd0dc78452dfb878a78a5f53e5dfc95f07a67/src/Generator/WilliamsonGenerator.jl#L1-L39">source</a></section></article><h2 id="w_trans_section"><a class="docs-heading-anchor" href="#w_trans_section">Inverse Williamson d-transform</a><a id="w_trans_section-1"></a><a class="docs-heading-anchor-permalink" href="#w_trans_section" title="Permalink"></a></h2><p>The Williamson d-transform is a bijective transformation<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> from the set of positive random variables to the set of generators. It therefore has an inverse transformation (called, surprisingly, the inverse Williamson <span>$d$</span>-transform) that construct the positive random variable <em>R</em> from a generator <span>$\phi$</span>.</p><p>This transformation is implemented through one method in the Generator interface that is worth talking a bit about : <code>williamson_dist(G::Generator, d)</code>. This function computes the inverse Williamson d-transform of the d-monotone archimedean generator œï, still using the <a href="https://github.com/lrnv/WilliamsonTransforms.jl"><code>WilliamsonTransforms.jl</code></a> package. See [<a href="../../references/#mcneil2009">20</a>, <a href="../../references/#williamson1955multiply">21</a>].</p><p>To put it in a nutshell, for <span>$\phi$</span> a <span>$d$</span>-monotone archimedean generator, the inverse Williamson-d-transform of <span>$\\phi$</span> is the cumulative distribution function <span>$F$</span> of a non-negative random variable <span>$R$</span>, defined by : </p><p class="math-container">\[F(x) = ùí≤_{d}^{-1}(\phi)(x) = 1 - \frac{(-x)^{d-1} \phi_+^{(d-1)}(x)}{k!} - \sum_{k=0}^{d-2} \frac{(-x)^k \phi^{(k)}(x)}{k!}\]</p><p>The <a href="https://github.com/lrnv/WilliamsonTransforms.jl"><code>WilliamsonTransforms.jl</code></a> package implements this transformation (and its inverse, the Williamson d-transfrom) in all generality. It returns this cumulative distribution function in the form of the corresponding random variable <code>&lt;:Distributions.ContinuousUnivariateDistribution</code> from <code>Distributions.jl</code>. You may then compute : </p><ul><li>The cdf via <code>Distributions.cdf</code></li><li>The pdf via <code>Distributions.pdf</code> and the logpdf via <code>Distributions.logpdf</code></li><li>Samples from the distribution via <code>rand(X,n)</code>.</li></ul><p>As an example of a generator produced by the Williamson transformation and its inverse, we propose to construct a generator from a LogNormal distribution:</p><pre><code class="language-julia hljs">using Distributions
using Copulas: iùí≤, œï‚Åª¬π, IndependentGenerator
using Plots
G = iùí≤(LogNormal(), 2)
plot(x -&gt; œï‚Åª¬π(G,x), xlims=(0.1,0.9), label=&quot;G&quot;)
plot!(x -&gt; œï‚Åª¬π(IndependentGenerator(),x), label=&quot;Independence&quot;)</code></pre><img src="b64d0d7c.svg" alt="Example block output"/><p>The <code>iùí≤</code> alias stands for <code>WiliamsonGenerator</code>. To stress the generality of the approach, remark that any positive distribution is allowed, including discrete ones: </p><pre><code class="language-julia hljs">using Distributions
using Copulas: iùí≤, œï‚Åª¬π
using Plots
G1 = iùí≤(Binomial(10,0.3), 2)
G2 = iùí≤(Binomial(10,0.3), 3)
plot(x -&gt; œï‚Åª¬π(G1,x), xlims=(0.1,0.9), label=&quot;G1&quot;)
plot!(x -&gt; œï‚Åª¬π(G2,x), xlims=(0.1,0.9), label=&quot;G2&quot;)</code></pre><img src="0ae71f37.svg" alt="Example block output"/><p>As obvious from the definition of the Williamson transform, using a discrete distribution produces piecewise-linear generators, where the number of pieces is dependent on the order of the transformation. </p><h2 id="Archimedean-copulas"><a class="docs-heading-anchor" href="#Archimedean-copulas">Archimedean copulas</a><a id="Archimedean-copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Archimedean-copulas" title="Permalink"></a></h2><p>Let&#39;s first define formally archimedean copulas: </p><blockquote><p><strong>Definition (Archimedean copula):</strong> If <span>$\phi$</span> is a <span>$d$</span>-monotonous Archimedean generator, then the function </p><p class="math-container">\[C(\bm u) = \phi\left(\sum\limits_{i=1}^d \phi^{-1}(u_i)\right)\]</p><p>is a copula. </p></blockquote><p>There are a few archimedean generators that are worth noting since they correspond to known archimedean copulas families: </p><ul><li><a href="../available_models/#IndependentGenerator"><code>IndependentGenerator</code></a>: <span>$\phi(t) =e^{-t} \text{ generates } \Pi$</span>.</li><li><a href="../available_models/#ClaytonGenerator"><code>ClaytonGenerator</code></a>: <span>$\phi_{\theta}(t) = \left(1+t\theta\right)^{-\theta^{-1}}$</span> generates the <span>$\mathrm{Clayton}(\theta)$</span> copula.</li><li><a href="../available_models/#GumbelGenerator"><code>GumbelGenerator</code></a>: <span>$\phi_{\theta}(t) = \exp\{-t^{\theta^{-1}}\}$</span> generates the <span>$\mathrm{Gumbel}(\theta)$</span> copula.</li><li><a href="../available_models/#FrankGenerator"><code>FrankGenerator</code></a>: <span>$\phi_{\theta}(t) = -\theta^{-1}\ln\left(1+e^{-t-\theta}-e^{-t}\right)$</span> generates the <span>$\mathrm{Franck}(\theta)$</span> copula.</li></ul><p>There are a lot of others implemented in the package, see our <a href="../available_models/#available_archimedean_models">large list of implemented archimedean generator</a>. </p><p>Archimedean copulas have a nice decomposition, called the Radial-simplex decomposition: </p><blockquote><p><strong>Property (Radial-simplex decomposition [<a href="../../references/#mcneil2009">20</a>, <a href="../../references/#mcneil2008">22</a>]):</strong> A <span>$d$</span>-variate random vector <span>$\bm U$</span> following an Archimedean copula with generator <span>$\phi$</span> can be decomposed into </p><p class="math-container">\[\bm U = \phi.(\bm S R),\]</p><p>where <span>$\bm S$</span> is uniform on the <span>$d$</span>-variate simplex and <span>$R$</span> is a non-negative random variable, independent form <span>$\bm S$</span>, defined as the inverse Williamson <span>$d$</span>-transform of <span>$\phi$</span>.  </p></blockquote><p>This is why <code>williamson_dist(G::Generator,d)</code> is such an important function in the API: it allows to generator the radial part and sample the Archimedean copula. You may call this function directly to see what distribution will be used: </p><pre><code class="language-julia hljs">using Copulas: williamson_dist, FrankCopula
williamson_dist(FrankCopula(3,7))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Copulas.WilliamsonFromFrailty{Copulas.Logarithmic{Float64}, 3}(
frailty_dist: Copulas.Logarithmic{Float64}(Œ±=0.9990881180344455, h=-7.0)
)
</code></pre><p>For the Frank Copula, as for many classic copulas, the distribution used is known. We pull some of them from <code>Distributions.jl</code> but implement a few more, as this Logarithmic one. Another useful example are negatively-dependent Clayton copulas: </p><pre><code class="language-julia hljs">using Copulas: williamson_dist, ClaytonCopula
williamson_dist(ClaytonCopula(3,-0.2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Copulas.ClaytonWilliamsonDistribution{Float64, Int64}(Œ∏=-0.2, d=3)</code></pre><p>for which the corresponding distribution is known but has no particular name, thus we implemented it under the <code>ClaytonWilliamsonDistribution</code> name.</p><div class="admonition is-info"><header class="admonition-header">Frailty decomposition for completely monotonous generators</header><div class="admonition-body"><p>It is well-known that completely monotone generators are Laplace transforms of non-negative random variables. This gives rise to another decomposition:</p><blockquote><p><strong>Property (Frailty decomposition [<a href="../../references/#hofert2013">23</a>]:</strong> When <span>$\phi$</span> is completely monotone, it is the Laplace transform of a non-negative random variable <span>$W$</span> such that</p><p class="math-container">\[\bm U = \phi(\bm Y / W),\]</p><p>where <span>$\bm Y$</span> is a vector of independent and identically distributed (i.i.d.) exponential distributions.</p></blockquote><p>The link between the distribution of <span>$R$</span> and the distribution of <span>$W$</span> can be explicited. We exploit this link and provide the <code>WilliamsonFromFrailty()</code> constructor that construct the distribution of <span>$R$</span> from the distribution of <span>$W$</span> and returns the corresponding  <code>WilliamsonGenerator</code> from the frailty distribution itself. The corresponding œï is simply the laplace transform of <span>$W$</span>. This is another potential way of constructing new archimedean copulas !  </p><p>We use this fraily approach for several generators, since sometimes it is faster, including e.g. the Clayton one with positive dependence:</p><pre><code class="language-julia hljs">using Copulas: williamson_dist, ClaytonCopula
williamson_dist(ClaytonCopula(3,10))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Copulas.WilliamsonFromFrailty{Distributions.Gamma{Float64}, 3}(
frailty_dist: Distributions.Gamma{Float64}(Œ±=0.1, Œ∏=10.0)
)
</code></pre></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.ArchimedeanCopula" href="#Copulas.ArchimedeanCopula"><code>Copulas.ArchimedeanCopula</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ArchimedeanCopula{d, TG}</code></pre><p>Fields:      - G::TG : the generator &lt;: Generator. </p><p>Constructor: </p><pre><code class="nohighlight hljs">ArchimedeanCopula(d::Int,G::Generator)</code></pre><p>For some Archimedean <a href="#Copulas.Generator"><code>Generator</code></a> <code>G::Generator</code> and some dimenson <code>d</code>, this class models the archimedean copula which has this generator. The constructor checks for validity by ensuring that <code>max_monotony(G) ‚â• d</code>. The <span>$d$</span>-variate archimedean copula with generator <span>$\phi$</span> writes: </p><p class="math-container">\[C(\mathbf u) = \phi^{-1}\left(\sum_{i=1}^d \phi(u_i)\right)\]</p><p>The default sampling method is the Radial-simplex decomposition using the Williamson transformation of <span>$\phi$</span>. </p><p>There exists several known parametric generators that are implement in the package. For every <code>NamedGenerator &lt;: Generator</code> implemented in the package, we provide a type alias `<code>NamedCopula{d,...} = ArchimedeanCopula{d,NamedGenerator{...}}</code> to be able to manipulate the classic archimedean copulas without too much hassle for known and usefull special cases. </p><p>A generic archimdean copula can be constructed as follows: </p><pre><code class="language-julia hljs">struct MyGenerator &lt;: Generator end
œï(G::MyGenerator,t) = exp(-t) # your archimedean generator, can be any d-monotonous function.
max_monotony(G::MyGenerator) = Inf # could depend on generators parameters. 
C = ArchimedeanCopula(d,MyGenerator())</code></pre><p>The obtained model can be used as follows: </p><pre><code class="language-julia hljs">spl = rand(C,1000)   # sampling
cdf(C,spl)           # cdf
pdf(C,spl)           # pdf
loglikelihood(C,spl) # llh</code></pre><p>Bonus: If you know the Williamson d-transform of your generator and not your generator itself, you may take a look at <a href="../available_models/#WilliamsonGenerator"><code>WilliamsonGenerator</code></a> that implements them. If you rather know the frailty distribution, take a look at <code>WilliamsonFromFrailty</code>.</p><p>References:</p><ul><li>[<a href="../../references/#williamson1955multiply">21</a>] Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189‚Äì207. MR0077581</li><li>[<a href="../../references/#mcneil2009">20</a>] McNeil, A. J., &amp; Ne≈°lehov√°, J. (2009). Multivariate Archimedean copulas, d-monotone functions and ‚Ñì 1-norm symmetric distributions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/f77fd0dc78452dfb878a78a5f53e5dfc95f07a67/src/ArchimedeanCopula.jl#L1-L43">source</a></section></article><p>&lt;!‚Äì  TODO: Make a few graphs of bivariate archimedeans pdfs and cdfs. And provide a few more standard tools for these copulas ?  ‚Äì&gt;</p><div class="citation noncanonical"><dl><dt>[20]</dt><dd><div>A.¬†J.¬†McNeil and J.¬†Ne≈°lehov√°. <em>Multivariate Archimedean Copulas, d -Monotone Functions and L1 -Norm Symmetric Distributions</em>. The¬†Annals¬†of¬†Statistics <strong>37</strong>, 3059‚Äì3097 (2009).</div></dd><dt>[21]</dt><dd><div>R.¬†E.¬†Williamson. <em>On multiply monotone functions and their laplace transforms</em> (Mathematics Division, Office of Scientific Research, US Air Force, 1955).</div></dd><dt>[22]</dt><dd><div>A.¬†J.¬†McNeil. <em>Sampling Nested Archimedean Copulas</em>. Journal¬†of¬†Statistical¬†Computation¬†and¬†Simulation <strong>78</strong>, 567‚Äì581 (2008).</div></dd><dt>[23]</dt><dd><div>M.¬†Hofert, M.¬†M√§chler and A.¬†J.¬†McNeil. <em>Archimedean Copulas in High Dimensions: Estimators and Numerical Challenges Motivated by Financial Applications</em>. Journal¬†de¬†la¬†Soci√©t√©¬†Fran√ßaise¬†de¬†Statistique <strong>154</strong>, 25‚Äì63 (2013).</div></dd></dl></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>This bijection is to be taken carefuly: the bijection is between random variables <em>with unit scales</em> and generators <em>with common value at 1</em>, sicne on both rescaling does not change the underlying copula. </li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../elliptical/generalities/">¬´ Elliptical Copulas</a><a class="docs-footer-nextpage" href="../../Liouville/">Liouville Copulas ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 20 August 2024 10:31">Tuesday 20 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
