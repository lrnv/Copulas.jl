<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Elliptical Copulas · Copulas.jl</title><meta name="title" content="Elliptical Copulas · Copulas.jl"/><meta property="og:title" content="Elliptical Copulas · Copulas.jl"/><meta property="twitter:title" content="Elliptical Copulas · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Copulas.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Copulas.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li class="is-active"><a class="tocitem" href>Elliptical Copulas</a><ul class="internal"><li><a class="tocitem" href="#Definition"><span>Definition</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../../archimedean/generalities/">Archimedean Generators</a></li><li><a class="tocitem" href="../../extremevalue/generalities/">Extreme Value Copulas</a></li><li><a class="tocitem" href="../../empirical/generalities/">Empirical Copulas</a></li><li><a class="tocitem" href="../../Vines/">Vines Copulas</a></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li></ul></li><li><span class="tocitem">Bestiary</span><ul><li><a class="tocitem" href="../available_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Archimedean Generators</a></li><li><a class="tocitem" href="../../extremevalue/available_models/">Extreme Values Copulas</a></li><li><a class="tocitem" href="../../empirical/available_models/">Empirical Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/lambda_viz/">Empirical Kendall function and Archimedean&#39;s λ function.</a></li><li><a class="tocitem" href="../../examples/lossalae/">Loss-Alae fitting example.</a></li><li><a class="tocitem" href="../../examples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../examples/ifm1/">Influence of the method of estimation</a></li><li><a class="tocitem" href="../../examples/turing/">Bayesian inference with <code>Turing.jl</code></a></li><li><a class="tocitem" href="../../examples/other_usecases/">Other known use cases.</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Elliptical Copulas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Elliptical Copulas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/elliptical/generalities.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="elliptical_copulas_header"><a class="docs-heading-anchor" href="#elliptical_copulas_header">Elliptical Copulas</a><a id="elliptical_copulas_header-1"></a><a class="docs-heading-anchor-permalink" href="#elliptical_copulas_header" title="Permalink"></a></h1><h2 id="Definition"><a class="docs-heading-anchor" href="#Definition">Definition</a><a id="Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Definition" title="Permalink"></a></h2><p>The easiest families of copulas are the one derived from known families of random vectors, and the first presented one are, generally, the Elliptical families (in particular, the Gaussian and Student families are very standard in the litterature). </p><div class="admonition is-category-definition"><header class="admonition-header">Definition (Spherical and elliptical random vectors):</header><div class="admonition-body"><p>A random vector <span>$\bm X$</span> is said to be spherical if for all orthogonal matrix <span>$\bm A \in O_d(\mathbb R)$</span>, <span>$\bm A\bm X \sim \bm X$</span>. </p><p>For every matrix <span>$\bm B$</span> and vector <span>$\bm c$</span>, the random vector <span>$\bm B \bm X + \bm c$</span> is then said to be elliptical.</p></div></div><p>Spherical random vectors have several interesting properties. First, the shape of the distribution must be the same in every direction since it is stable by rotations. Moreover, their characteristic functions (c.f.) only depend on the norm of their arguments. Indeed, for any <span>$\bm A \in O_d(\mathbb R)$</span>, </p><p class="math-container">\[\phi(\bm t) = \mathbb E\left(e^{\langle \bm t, \bm X \rangle}\right)= \mathbb E\left(e^{\langle \bm t, \bm A\bm X \rangle}\right) = \mathbb E\left(e^{\langle \bm A\bm t, \bm X \rangle}\right) = \phi(\bm A\bm t).\]</p><p>We can therefore express this characteristic function as <span>$\phi(\bm t) = \psi(\lVert \bm t \rVert_2^2)$</span>, where <span>$\psi$</span> is a function that characterizes the spherical family, called the <em>generator</em> of the family. Any characteristic function that can be expressed as a function of the norm of its argument is the characteristic function of a spherical random vector, since <span>$\lVert \bm A \bm t \rVert_2 = \lVert \bm t \rVert_2$</span> for any orthogonal matrix <span>$\bm A$</span>. </p><p>This class contains the (multivariate) Normal and Student distributions, and it is easy to construct others if needed. This is a generalization of the family of Gaussian random vectors, and they benefit from several nice properties of the former, among which, particularly interesting, the stability by convolution. Indeed, convolutions correspond to product of characteristic functions, and</p><p class="math-container">\[\phi(\bm t) = \prod_{i=1}^n \phi_i(\bm t) = \prod_{i=1}^n \psi_i(\lVert \bm t \rVert_2^2) = \psi(\lVert \bm t \rVert_2^2),\]</p><p>which is still a function of only the norm of <span>$\bm t$</span>. </p><p>To fix ideas, for Gaussian random vectors, <span>$\psi(t) = e^{-\frac{t^2}{2}}$</span>.</p><div class="admonition is-info"><header class="admonition-header">Sampling with `Distributions.jl`</header><div class="admonition-body"><p>Elliptical random vectors in the Gaussian and Student families are available from <code>Distributions.jl</code>:</p><pre><code class="language-julia hljs">using Distributions
Σ = [1 0.5
    0.5 1] # variance-covariance matrix.
ν = 3 # number of degrees of freedom for the student.
N = MvNormal(Σ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ZeroMeanFullNormal(
dim: 2
μ: Zeros(2)
Σ: [1.0 0.5; 0.5 1.0]
)
</code></pre><pre><code class="language-julia hljs">T = MvTDist(ν,Σ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Distributions.GenericMvTDist{Float64, PDMats.PDMat{Float64, Matrix{Float64}}, FillArrays.Zeros{Float64, 1, Tuple{Base.OneTo{Int64}}}}(
df: 3.0
dim: 2
μ: Zeros(2)
Σ: [1.0 0.5; 0.5 1.0]
)
</code></pre></div></div><p>Elliptical copulas are simply copulas of elliptical distributions. This simplicity of definition is paid for in the expression of the copulas itself: the obtained function has usually no better expression than: </p><p class="math-container">\[C = F \circ (F_1^{-1},...,F_d^{-1}),\]</p><p>where <span>$F_i^{-1}$</span> denotes the almost-inverse of <span>$F_i$</span>, that is: </p><p class="math-container">\[\forall u \in [0,1],\;F_i^{-1}(u) = \inf\left\{x :\, F_i(x) \ge u\right\},\]</p><p>and <span>$F_i$</span> is usually hard to express from the elliptical assumptions.</p><p>Moreover, the form of dependence structures that can be reached inside this class is restricted. The elliptical copulas are parametrized by the corresponding univariate spherical generator and a correlation matrix, which is a very simple structure. See also [<a href="../../references/#frahm2003">13</a>–<a href="../../references/#cote2019">15</a>] for details on these copulas. </p><p>On the other hand, there exist performant estimators of high-dimensional covariance matrices, and a large theory is built on the elliptical assumption of high dimensional random vectors, see e.g., [<a href="../../references/#elidan2013">16</a>–<a href="../../references/#muller2019">18</a>] among others. See also [<a href="../../references/#derumigny2022">19</a>] for a recent work on nonparametric estimation of the underlying univariate spherical distribution. </p><div class="admonition is-info"><header class="admonition-header">Note on internal implementation</header><div class="admonition-body"><p>If the exposition we just did on characteristic functions of Elliptical random vectors is fundamental to the definition of elliptical copulas, the package does not use this at all to function, and rather rely on the existence of multivariate and corresponding univariate families of distributions in <code>Distributions.jl</code>. </p></div></div><p>You can obtain these elliptical copulas by the following code: </p><pre><code class="language-julia hljs">using Copulas
Σ = [1 0.5
     0.5 1] # variance-covariance matrix.
ν = 3 # number of degrees of freedom for the student.
C_N = GaussianCopula(Σ)
C_T = TCopula(ν,Σ)</code></pre><p>As already stated, the underlying code simply applies Sklar. In all generalities, you may define another elliptical copula by the following structure: </p><pre><code class="language-julia hljs">struct MyElliptical{d,T} &lt;: EllipticalCopula{d,T}
    θ:T
end
U(::Type{MyElliptical{d,T}}) where {d,T} # Distribution of the univaraite marginals, Normal() for the Gaussian case. 
N(::Type{MyElliptical{d,T}}) where {d,T} # Distribution of the mutlivariate random vector, MvNormal(\Sigma) for the Gaussian case. </code></pre><p>However, not much other cases than the Gaussian and Elliptical one are really used in the literature.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>To construct, e.g., a Student copula, you need to provide the Correlation matrix and the number of degree of freedom, as follows: </p><pre><code class="language-julia hljs">using Copulas, Distributions
Σ = [1 0.5
    0.5 1] # variance-covariance matrix.
ν = 3 # number of degrees of freedom
C = TCopula(ν,Σ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TCopula{2, 3, Matrix{Float64}}(
Σ: [1.0 0.5; 0.5 1.0]
)
</code></pre><p>You can sample it and compute its density and distribution functions via the standard interface. We could try to fit a GaussianCopula on the sampled data, even if we already know that the tails will not be properly taken into account: </p><pre><code class="language-julia hljs">u = rand(C,1000)
Ĉ = fit(GaussianCopula,u) # to fit on the sampled data.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GaussianCopula{2, Matrix{Float64}}(
Σ: [0.9999999999999998 0.48777091284707425; 0.48777091284707425 0.9999999999999999]
)
</code></pre><p>We see that the estimation we have on the correlation matrix is quite good, but rest assured that the tails of the distributions are not the same at all. To see that, let&#39;s plot the lower tail function (see [<a href="../../references/#nelsen2006">3</a>]) for both copulas: </p><pre><code class="language-julia hljs">using Plots
chi(C,u) = 2 * log(1-u) / log(1 - 2u + cdf(C,[u,u])) -1
u = 0.5:0.03:0.99
plot(u,  chi.(Ref(C),u), label=&quot;True student copula&quot;)
plot!(u, chi.(Ref(Ĉ),u), label=&quot;Estimated Gaussian copula&quot;)</code></pre><img src="c66a5eb3.svg" alt="Example block output"/><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.EllipticalCopula" href="#Copulas.EllipticalCopula"><code>Copulas.EllipticalCopula</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EllipticalCopula{d,MT}</code></pre><p>This is an abstract type. It implements an interface for all Elliptical copulas. We construct internally elliptical copulas using the sklar&#39;s theorem, by considering the copula <span>$C$</span> to be defined as : </p><p class="math-container">\[C = F \circ (F_1^{-1},...,F_d^{-1}),\]</p><p>where <span>$F$</span> and <span>$F_1,...,F_d$</span> are respectively the multivariate distribution function of some elliptical random vector and the univariate distribution function of its marginals.  For a type <code>MyCop &lt;: EllipitcalCopula</code>, it is necessary to implement the following methods: </p><ul><li><code>N(::Type{MyCOp})</code>, returning the constructor of the elliptical random vector from its correlation matrix. For example, <code>N(GaussianCopula)</code> simply returns <code>MvNormal</code> from <code>Distributions.jl</code>.</li><li><code>U(::Type{MyCOp})</code>, returning the constructor for the univariate marginal, usually in standardized form. For example, <code>U(GaussianCopula)</code> returns <code>Normal</code> from <code>Distributions.jl</code>.</li></ul><p>From these two functions, the abstract type provides a fully functional copula. </p><p><strong>Details</strong></p><p>Recall the definition of spherical random vectors: </p><div class="admonition is-category-definition"><header class="admonition-header">Definition (Spherical and elliptical random vectors):</header><div class="admonition-body"><p>A random vector <span>$\bm X$</span> is said to be spherical if for all orthogonal matrix <span>$\bm A \in O_d(\mathbb R)$</span>, <span>$\bm A\bm X \sim \bm X$</span>. </p><p>For every matrix <span>$\bm B$</span> and vector <span>$\bm c$</span>, the random vector <span>$\bm B \bm X + \bm c$</span> is then said to be elliptical.</p></div></div><p>Recall that spherical random vectors are random vectors which characteristic functions (c.f.) only depend on the norm of their arguments. Indeed, for any <span>$\bm A \in O_d(\mathbb R)$</span>, </p><p class="math-container">\[\phi(\bm t) = \mathbb E\left(e^{\langle \bm t, \bm X \rangle}\right)= \mathbb E\left(e^{\langle \bm t, \bm A\bm X \rangle}\right) = \mathbb E\left(e^{\langle \bm A\bm t, \bm X \rangle}\right) = \phi(\bm A\bm t).\]</p><p>We can therefore express this characteristic function as <span>$\phi(\bm t) = \psi(\lVert \bm t \rVert_2^2)$</span>, where <span>$\psi$</span> is a function that characterizes the spherical family, called the <em>generator</em> of the family. Any characteristic function that can be expressed as a function of the norm of its argument is the characteristic function of a spherical random vector, since <span>$\lVert \bm A \bm t \rVert_2 = \lVert \bm t \rVert_2$</span> for any orthogonal matrix <span>$\bm A$</span>. </p><p>However, note that this is not how the underlying code is working, we do not check for validity of the proposed generator (we dont even use it). You can construct such an elliptical family using simply Sklar: </p><pre><code class="language-julia hljs">struct MyElliptical{d,T} &lt;: EllipticalCopula{d,T}
    θ:T
end
U(::Type{MyElliptical{d,T}}) where {d,T} # Distribution of the univaraite marginals, Normal() for the Gaussian case. 
N(::Type{MyElliptical{d,T}}) where {d,T} # Distribution of the mutlivariate random vector, MvNormal(C.Σ) for the Gaussian case. </code></pre><p>These two functions are enough to implement the rest of the interface. </p><p>References:</p><ul><li>[<a href="../../references/#nelsen2006">3</a>] Nelsen, Roger B. An introduction to copulas. Springer, 2006.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/e6c360270d6daaccccac889833f2017544ea1717/src/EllipticalCopula.jl#L1-L48">source</a></section></article><div class="citation noncanonical"><dl><dt>[3]</dt><dd><div>R. B. Nelsen. <em>An Introduction to Copulas</em>. 2nd ed Edition, <em>Springer Series in Statistics</em> (Springer, New York, 2006).</div></dd><dt>[13]</dt><dd><div>G. Frahm, M. Junker and A. Szimayer. <em>Elliptical Copulas: Applicability and Limitations</em>. Statistics &amp; Probability Letters <strong>63</strong>, 275–286 (2003).</div></dd><dt>[14]</dt><dd><div>E. Gómez, M. A. Gómez-villegas and J. M. Marín. <em>A Survey on Continuous Elliptical Vector Distributions</em>. Revista Matemática Complutense <strong>16</strong>, 345–361 (2003).</div></dd><dt>[15]</dt><dd><div>M.-P. Côté and C. Genest. <em>Dependence in a Background Risk Model</em>. Journal of Multivariate Analysis <strong>172</strong>, 28–46 (2019).</div></dd><dt>[16]</dt><dd><div>G. Elidan. <em>Copulas in Machine Learning</em>. In: <em>Copulae in Mathematical and Quantitative Finance</em>, Vol. 213, edited by P. Jaworski, F. Durante and W. K. Härdle (Springer Berlin Heidelberg, Berlin, Heidelberg, 2013); pp. 39–60.</div></dd><dt>[17]</dt><dd><div>J. Friedman, T. Hastie and R. Tibshirani. <em>Applications of the Lasso and Grouped Lasso to the Estimation of Sparse Graphical Models</em> (Technical report, Stanford University, 2010).</div></dd><dt>[18]</dt><dd><div>D. Müller and C. Czado. <em>Dependence Modelling in Ultra High Dimensions with Vine Copulas and the Graphical Lasso</em>. Computational Statistics &amp; Data Analysis <strong>137</strong>, 211–232 (2019).</div></dd><dt>[19]</dt><dd><div>A. Derumigny and J.-D. Fermanian. <em>Identifiability and Estimation of Meta-Elliptical Copula Generators</em>. Journal of Multivariate Analysis, 104962 (2022).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../sklar/">« Sklar&#39;s Distributions</a><a class="docs-footer-nextpage" href="../../archimedean/generalities/">Archimedean Generators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 10 January 2025 12:08">Friday 10 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
