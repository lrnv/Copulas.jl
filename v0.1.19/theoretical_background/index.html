<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical Background · Copulas.jl</title><meta name="title" content="Theoretical Background · Copulas.jl"/><meta property="og:title" content="Theoretical Background · Copulas.jl"/><meta property="twitter:title" content="Theoretical Background · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/theoretical_background/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/theoretical_background/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/theoretical_background/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Copulas.jl package</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Theoretical Background</a></li><li><a class="tocitem" href="../sklar/">Sklar&#39;s Theorem</a></li><li><span class="tocitem">Elliptical Copulas</span><ul><li><a class="tocitem" href="../elliptical/generalities/">General Discussion</a></li><li><a class="tocitem" href="../elliptical/available_models/">Available elliptical copulas</a></li></ul></li><li><span class="tocitem">Archimedean Copulas</span><ul><li><a class="tocitem" href="../archimedean/generalities/">General Discussion</a></li><li><a class="tocitem" href="../archimedean/generators/">Archimedean Generators</a></li><li><a class="tocitem" href="../archimedean/available_models/">Available Archimedean models</a></li></ul></li><li><a class="tocitem" href="../miscellaneous/">Other Copulas</a></li><li><span class="tocitem">Exemples</span><ul><li><a class="tocitem" href="../exemples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../exemples/turing/">Bayesian inference with Turing.jl</a></li></ul></li><li><a class="tocitem" href="../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../idx/">Package Index</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theoretical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/theoretical_background.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Copulas-and-dependence-structures"><a class="docs-heading-anchor" href="#Copulas-and-dependence-structures">Copulas and dependence structures</a><a id="Copulas-and-dependence-structures-1"></a><a class="docs-heading-anchor-permalink" href="#Copulas-and-dependence-structures" title="Permalink"></a></h1><p>This section gives some general definitions and tools about dependence structures. Along this journey through the mathematical theory of copulas, we take the chance to introduce more specifically several topics that will be exploited in the following chapters. The interested reader can take a look at the standard books [<a href="../references/#joe1997">1</a>–<a href="../references/#joe2014">4</a>] or more recently [<a href="../references/#mai2017">5</a>–<a href="../references/#grosser2021">8</a>] on the subject of copulas. We start by defining a few concepts about dependence structures and copulas.</p><p>Consider a real valued random vector <span>$\bm X = \left(X_1,...,X_d\right): \Omega \to \mathbb R^d$</span>. The distribution of the random vector <span>$\bm X$</span> can be characterized by its distribution function  <span>$F$</span>: </p><p class="math-container">\[\begin{align*}
  F(\bm x) &amp;= \mathbb P\left(\bm X \le \bm x\right)\\
  &amp;= \mathbb P\left(\forall i \in \{1,...,d\},\; X_i \le x_i\right).
\end{align*}\]</p><p>For a function <span>$F$</span> to be the distribution function of some random vector, it should be <span>$d$</span>-increasing, right-continuous and left-limited.  For <span>$i \in \{1,...,d\}$</span>, the random variables <span>$X_1,...,X_d$</span>, called the marginals of the random vector, also have distribution functions denoted <span>$F_1,...,F_d$</span> and defined by : </p><p class="math-container">\[F_i(x_i) = F(+\infty,...,+\infty,x_i,+\infty,...,+\infty).\]</p><p>Note that the range <span>$\mathrm{Ran}(F)$</span> of a distribution function <span>$F$</span>, univariate or multivariate, is always contained in <span>$[0,1]$</span>. When the random vector or random variable is absolutely continuous with respect to (w.r.t.) the Lebesgue measure restricted to its domain, the range is exactly <span>$[0,1]$</span>. When the distribution is discrete with <span>$n$</span> atoms, the range is a finite set of <span>$n+1$</span> values in <span>$[0,1]$</span>.</p><p>There is a fundamental functional link between the function <span>$F$</span> and its marginals <span>$F_1,...,F_d$</span>. This link is expressed by the mean of *copulas. </p><blockquote><p><strong>Definition (Copula) :</strong> A copula, usually denoted <span>$C$</span>, is the distribution function of a random vector with marginals that are all uniform on <span>$[0,1]$</span>, i.e.</p><p class="math-container">\[C_i(u) = u\mathbb 1_{u \in [0,1]} \text{ for all }i \in 1,...,d.\]</p></blockquote><p>At the grounds of the theory of copulas lies Sklar&#39;s Theorem [<a href="../references/#sklar1959">9</a>], dating back from 1959.</p><blockquote><p><strong>Theorem (Sklar):</strong> For every random vector <span>$\bm X$</span>, there exists a copula <span>$C$</span> such that </p><p class="math-container">\[\forall \bm x\in \mathbb R^d, F(\bm x) = C(F_{1}(x_{1}),...,F_{d}(x_{d})).\]</p><p>The copula <span>$C$</span> is uniquely determined on <span>$\mathrm{Ran}(F_{1}) \times ... \times \mathrm{Ran}(F_{d})$</span>, where <span>$\mathrm{Ran}(F_i)$</span> denotes the range of the function <span>$F_i$</span>. In particular, if all marginals are absolutely continuous, <span>$C$</span> is unique.</p></blockquote><p>This result allows to decompose the distribution of <span>$\bm X$</span> into several components: the marginal distributions on one side, and the copula on the other side, which governs the dependence structure between the marginals. This object is central in our work, and therefore deserves a moment of attention. </p><blockquote><p><strong>Example (Independence):</strong> The function </p><p class="math-container">\[\Pi : \bm x \mapsto \prod_{i=1}^d x_i = \bm x^{\bm 1}\]</p><p>is a copula, corresponding to independent random vectors.</p></blockquote><p>Copulas are bounded functions</p><blockquote><p><strong>Property (Fréchet-Hoeffding bounds [<a href="../references/#lux2017">10</a>]:</strong> For all <span>$\bm x \in [0,1]^d$</span>, every copula <span>$C$</span> satisfies : </p><p class="math-container">\[\langle \bm 1, \bm x - 1 + d^{-1}\rangle_{+} \le C(\bm x) \le \min \bm x,\]</p><p>where <span>$y_{+} = \max(0,y)$</span>.</p></blockquote><blockquote><p><strong>Example (Fréchet-Hoeffding bounds [<a href="../references/#lux2017">10</a>]:</strong> The function <span>$M : \bm x \mapsto \min\bm x$</span>, called the upper Fréchet-Hoeffding bound, is a copula. The function <span>$W : \bm x \mapsto \langle \bm 1, \bm x - 1 + d^{-1}\rangle_{+}$</span>, called the lower Fréchet-Hoeffding bound, is on the other hand a copula only when <span>$d=2$</span>. </p></blockquote><p>The upper Fréchet-Hoeffding bound corresponds to the case of comonotone random vector: a random vector <span>$\bm X$</span> is said to be comonotone, i.e., to have copula <span>$M$</span>, when each of its marginals can be written as a non-decreasing transformation of the same random variable (say with <span>$\mathcal U\left([0,1]\right)$</span> distribution). This is a simple but important dependence structure. See e.g.,[<a href="../references/#kaas2002">11</a>, <a href="../references/#hua2017">12</a>] on this particular copula.</p><p>Since copulas are distribution functions, like distribution functions of real-valued random variables and random vectors, there exists classical and useful parametric families of copulas. We refer to [<a href="../references/#nelsen2006">3</a>] for a more complete list of parametric constructions, we only present a few families here and the package contains a few more.</p><p>The easiest families are the one derived from known families of random vectors, e.g., the elliptical family. </p><blockquote><p><strong>Definition (Spherical and elliptical random vectors):</strong> A random vector <span>$\bm X$</span> is said to be spherical if for all orthogonal matrix <span>$\bm A \in O_d(\mathbb R)$</span>, <span>$\bm A\bm X \sim \bm X$</span>. For every matrix <span>$\bm B$</span> and vector <span>$\bm c$</span>, the random vector <span>$\bm B \bm X + \bm c$</span> is then said to be elliptical.</p></blockquote><p>Spherical random vectors have several interesting properties. First, the shape of the distribution must be the same in every direction since it is stable by rotations. Moreover, their characteristic functions (c.f.) only depend on the norm of their arguments. Indeed, for any <span>$\bm A \in O_d(\mathbb R)$</span>, </p><p class="math-container">\[\phi(\bm t) = \mathbb E\left(e^{\langle \bm t, \bm X \rangle}\right)= \mathbb E\left(e^{\langle \bm t, \bm A\bm X \rangle}\right) = \mathbb E\left(e^{\langle \bm A\bm t, \bm X \rangle}\right) = \phi(\bm A\bm t).\]</p><p>We can therefore express this characteristic function as <span>$\phi(\bm t) = \psi(\lVert \bm t \rVert_2^2)$</span>, where <span>$\psi$</span> is a function that characterizes the spherical family, called the <em>generator</em> of the family. Any characteristic function that can be expressed as a function of the norm of its argument is the characteristic function of a spherical random vector, since <span>$\lVert \bm A \bm t \rVert_2 = \lVert \bm t \rVert_2$</span> for any orthogonal matrix <span>$\bm A$</span>. </p><p>This class contains the (multivariate) Normal and Student distributions, and it is easy to construct others if needed. This is a generalization of the family of Gaussian random vectors, and they benefit from several nice properties of the former, among which, particularly interesting, the stability by convolution. Indeed, convolutions correspond to product of characteristic functions, and</p><p class="math-container">\[\phi(\bm t) = \prod_{i=1}^n \phi_i(\bm t) = \prod_{i=1}^n \psi_i(\lVert \bm t \rVert_2^2) = \psi(\lVert \bm t \rVert_2^2),\]</p><p>which is still a function of only the norm of <span>$\bm t$</span>. To fix ideas, for Gaussian random vectors, <span>$\psi(t) = e^{-\frac{t^2}{2}}$</span>.</p><p>However, when looking at the copula associated to these distributions, the obtained function has usually no better expression than </p><p class="math-container">\[C = F \circ (F_1^{-1},...,F_d^{-1}),\]</p><p>where <span>$F_i^{-1}$</span> denotes the almost-inverse of <span>$F_i$</span>, that is: </p><p class="math-container">\[\forall u \in [0,1],\;F_i^{-1}(u) = \inf\left\{x :\, F_i(x) \ge u\right\},\]</p><p>and <span>$F_i$</span> is usually hard to express from the elliptical assumptions.</p><p>Moreover, the form of dependence structures that can be reached inside this class is restricted. The elliptical copulas are parametrized by the corresponding univariate spherical generator and a correlation matrix, which is a very simple structure. See also [<a href="../references/#frahm2003">13</a>–<a href="../references/#cote2019">15</a>] for details on these copulas.  On the other hand, there exist performant estimators of high-dimensional covariance matrices, and a large theory is built on the elliptical assumption of high dimensional random vectors, see e.g., \cite{elidan2013,friedman2010,muller2019} among others. See also [<a href="../references/#derumigny2022">16</a>] for a recent work on nonparametric estimation of the underlying univariate spherical distribution. </p><p>Another parametric class that is of interest is the class of Archimedean copulas. To define Archimedean copulas, we must take a look at their <em>generators</em>, which are unrelated to spherical generators, and must be <span>$d$</span>-monotone functions. </p><blockquote><p><strong>Definition (d-monotony [<a href="../references/#mcneil2009">17</a>]):</strong> A function <span>$\phi$</span> is said to be <span>$d$</span>-monotone if it has <span>$d-2$</span> derivatives which satisfy </p><p class="math-container">\[(-1)^k \phi^{(k)} \ge 0 \;\forall k \in \{1,..,d-2\}\]</p><p>, and if <span>$(-1)^{d-2}\phi^{(d-2)}$</span> is a non-increasing and convex function.  A function that is <span>$d$</span>-monotone for all <span>$d$</span> is called completely monotone.</p></blockquote><blockquote><p><strong>Definition (Archimedean generator):</strong> A <span>$d$</span>-Archimedean generator is a <span>$d$</span>-monotone function <span>$\phi :\mathbb R_+ \to [0,1]$</span> such that <span>$\phi(0) = 1, \lim_{x\to+\infty}\phi(x) = 0$</span>.</p></blockquote><blockquote><p><strong>Property (Archimedean copula):</strong> If <span>$\phi$</span> is a <span>$d$</span>-Archimedean generator, then the function </p><p class="math-container">\[C(\bm u) = \phi\left(\sum\limits_{i=1}^d \phi^{-1}(u_i)\right)\]</p><p>is a copula. </p></blockquote><blockquote><p><strong>Property (Completely monotone generator):</strong> A generator is completely monotone if and only if it generates a copula in any dimension.</p></blockquote><p>The following generators each correspond to standard parametric copula families: </p><ul><li><p class="math-container">\[\phi(t) =e^{-t} \text{ generates } \Pi\]</p>.</li><li><p class="math-container">\[\phi_{\theta}(t) = \left(1+t\theta\right)^{-\theta^{-1}}\]</p>generates the <span>$\mathrm{Clayton}(\theta)$</span> copula.</li><li><p class="math-container">\[\phi_{\theta}(t) = \exp\{-t^{\theta^{-1}}\}\]</p>generates the <span>$\mathrm{Gumbel}(\theta)$</span> copula.</li><li><p class="math-container">\[\phi_{\theta}(t) = -\theta^{-1}\ln\left(1+e^{-t-\theta}-e^{-t}\right)\]</p>generates the <span>$\mathrm{Franck}(\theta)$</span> copula.</li></ul><p>[ We could include here a figure that represents dataset drawn from one or two classic archimedeans.]</p><p>Archimedean copulas have a nice decomposition, called the Radial-simplex decomposition: </p><blockquote><p><strong>Property (Radial-simplex decomposition [<a href="../references/#mcneil2009">17</a>, <a href="../references/#mcneil2008">18</a>]:</strong> A <span>$d$</span>-variate random vector <span>$\bm U$</span> following an Archimedean copula with generator <span>$\phi$</span> can be decomposed into </p><p class="math-container">\[\bm U = \phi(\bm S R),\]</p><p>where <span>$\bm S$</span> is uniform on the <span>$d$</span>-variate simplex and <span>$R$</span> is a non-negative random variable, independent form <span>$\bm S$</span>, defined as the (inverse) Williamson <span>$d$</span>-transform of <span>$\phi$</span>.  </p></blockquote><p>See [<a href="../references/#mcneil2009">17</a>, <a href="../references/#mcneil2008">18</a>] for the definition of the Williamson <span>$d$</span>-transform and its inverse. It is well-known that completely monotone generators are Laplace transforms of non-negative random variables. This gives rise to another decomposition:</p><blockquote><p><strong>Property (Frailty decomposition [<a href="../references/#hofert2013">19</a>]:</strong> When <span>$\phi$</span> is completely monotone, it is the Laplace transform of a non-negative random variable <span>$W$</span> such that</p><p class="math-container">\[\bm U = \phi(\bm Y / W),\]</p><p>where <span>$\bm Y$</span> is a vector of independent and identically distributed (i.i.d.) exponential distributions.</p></blockquote><p>The two transformations are obviously linked, see [<a href="../references/#mcneil2009">17</a>] for details about this link. </p><p>Archimedean copulas have been widely used in the literature due to their nice decomposition properties and easy parametrization. The interested reader can refer to the extensive literature [<a href="../references/#hofert2010">20</a>–<a href="../references/#dibernardino2013a">26</a>, <a href="../references/#dibernardino2013a">26</a>–<a href="../references/#spreeuw2014">29</a>] on Archimedean copulas, their nesting extensions, the link from their generators to a certain radial-simplex parametrization, and most importantly their estimation.  One major drawback of the Archimedean family is that these copulas have exchangeable marginals (i.e., <span>$C(\bm u) = C(\mathrm{p}(\bm u))$</span> for any permutation <span>$p(\bm u)$</span> of <span>$u_1,...,u_d$</span>): the dependence structure is symmetric, which might not be a wanted property. However, from the Radial-simplex expression, we can easily extrapolate a little and take for <span>$\bm S$</span> a non-uniform distribution on the simplex. </p><blockquote><p><strong>Definition (Liouville copulas [<a href="../references/#mcneil2010">22</a>]):</strong> If <span>$\phi$</span> is a <span>$d$</span>-Archimedean generator with Williamson <span>$d$</span>-transform <span>$R$</span> and <span>$\bm S$</span> follows a Dirichlet distribution on the simplex, independent from <span>$R$</span></p><p class="math-container">\[\bm U = \phi(\bm S R)\]</p><p>still has uniform marginals. The corresponding copula is called a Liouville copula.  </p></blockquote><p>Liouville&#39;s copulas share many properties with Archimedean copulas, but are not exchangeable anymore. This is an easy way to produce non-exchangeable dependence structures. See [<a href="../references/#cote2019">15</a>] for a practical use of this property.</p><p>Note that Dirichlet distributions are constructed as <span>$\bm S = \frac{\bm G}{\langle \bm 1, \bm G\rangle}$</span>, where <span>$\bm G$</span> is a vector of independent Gamma distributions with unit scale (and potentially different shapes: taking all shapes equal yields the Archimedean case). </p><p>Due to the rigidity of the structure of Elliptical, Archimedean and even Liouville copulas, these models are not well suited for high dimensional cases where the form and strength of dependency might be varying a lot between subsets of marginals. More advanced parametric constructions exist, such as Hierarchical Archimedean copulas [<a href="../references/#zhu2017">30</a>–<a href="../references/#cossette2018a">35</a>], Vines copulas [<a href="../references/#muller2018">36</a>–<a href="../references/#nagler2018">38</a>], etc. Usually, some kind of <em>sparsity assumptions</em> are needed when working in high-dimensional cases.</p><p>Through the statistical process leading to the estimation of copulas, one usually observes the data and information on the marginals scale and not on the copula scale. This discrepancy between the observed information and the modeled distribution must be taken into account. A key concept is that of pseudo-observations. </p><blockquote><p><strong>Definition (Pseudo-observations):</strong> If <span>$\bm x \in \mathbb R^{N\times d}$</span> is an <span>$N$</span>-sample of a <span>$d$</span>-variate real-valued random vector <span>$\bm X$</span>, then the pseudo-observations are the normalized ranks of the marginals of <span>$\bm x$</span>, defined as : </p><p class="math-container">\[\bm u \in \mathbb [0,1]^{N\times d}:\; u_{i,j} = \frac{\mathrm{Rank}(x_{i,j},\,\bm x_{\cdot,j})}{N+1} = \frac{1}{N+1}\sum_{k=1}^N \mathbb 1_{x_{k,j} \le x_{i,j}},\]</p><p>where <span>$\mathrm{Rank}(y,\bm x)  = \sum\limits_{x_i \in \bm x} \mathbb 1_{x_i \le y}$</span>.</p></blockquote><p>From these pseudo-observations, an empirical copula is defined as follows:</p><blockquote><p><strong>Definition (Empirical Copula) [<a href="../references/#deheuvels1979">39</a>]:</strong> The empirical distribution function of the normalized ranks,</p><p class="math-container">\[\hat{C}_N(\bm u) = \frac{1}{N} \sum_{i=1}^N \mathbb 1_{\bm u_i \le \bm u},\]</p><p>is called the empirical copula function.</p></blockquote><blockquote><p><strong>Theorem (Exhaustivity and consistency [<a href="../references/#deheuvels1979">39</a>]):</strong> <span>$\hat{C}_N$</span> is an exhaustive estimator of <span>$C$</span>, and moreover for any normalizing constants <span>$\{\phi_N, N\in \mathbb N\}$</span> such that <span>$\lim\limits_{N \to \infty} \phi_N \sqrt{N^{-1}\ln \ln N} = 0$</span>, </p><p class="math-container">\[\lim\limits_{N\to\infty} \phi_N \sup_{\bm u \in [0,1]^d} \lvert\hat{C}_N(\bm u) - C(\bm u) \rvert = 0 \text{ a.s.}\]</p></blockquote><p class="math-container">\[\hat{C}_N\]</p><p>then converges (weakly) to <span>$C$</span>, the true copula of the random vector <span>$\bm X$</span>, when the number of observations <span>$N$</span> goes to infinity. However, despite its name, <span>$\hat{C}_N$</span> is not a copula since it does not have uniform marginals:</p><p class="math-container">\[\begin{align*}
  \hat{C}_N(1,...,1,y_j,1,...,1) &amp;= \frac{1}{N}\sum_{i=1}^N \mathbb 1_{u_{i,j} \le y_j}\\
  &amp;= \frac{1}{N}\sum_{i=1}^N \mathbb 1_{\mathrm{Rank}(x_{i,j},\bm x_{\cdot,j}) \le (N+1)y_j}\\
  &amp;= \frac{1}{N}\sum_{i=1}^N \mathbb 1_{i \le (N+1)y_j}\\
  &amp;= \frac{\lfloor(N+1)y_j\rfloor}{N} \neq y_j 
\end{align*}\]</p><p>Thus, the empirical copula function is not a copula. An easy way to fix this problem is to smooth out the marginals with beta distribution functions: </p><blockquote><p><strong>Definition (Beta Copula [<a href="../references/#segers2017">40</a>]):</strong> Denoting <span>$F_{n,r}(x) = \sum_{s=r}^n \binom{n}{s} x^s(1-x)^{n-s}$</span> the distribution function of a <span>$\mathrm{Beta}(r,n+1-r)$</span> random variable, the function </p><p class="math-container">\[\hat{C}_N^\beta : \bm x \mapsto \frac{1}{N} \sum_{i=1}^N \prod\limits_{j=1}^d F_{n,(N+1)u_{i,j}}(x_j)\]</p><p>is a genuine copula, called the Beta copula. </p></blockquote><blockquote><p><strong>Property (Proximity of <span>$\hat{C}_N$</span> and <span>$\hat{C}_N^\beta$</span> [<a href="../references/#segers2017">40</a>]):</strong></p><p class="math-container">\[\sup\limits_{\bm u \in [0,1]^d} \lvert \hat{C}_N(\bm u) - \hat{C}_N^\beta(\bm u) \rvert \le d\left(\sqrt{\frac{\ln n}{n}} + \sqrt{\frac{1}{n}} + \frac{1}{n}\right)\]</p></blockquote><p>There are other nonparametric estimators of the copula function that are true copulas. Of interest to our work is the Checkerboard construction (see [<a href="../references/#cuberos2019">41</a>, <a href="../references/#mikusinski2010">42</a>]), detailed below.</p><p>First, for any <span>$\bm m \in \mathbb N^d$</span>, let <span>$\left\{B_{\bm i,\bm m}, \bm i &lt; \bm m\right\}$</span> be a partition of the unit hypercube defined by </p><p class="math-container">\[B_{\bm i, \bm m} = \left]\frac{\bm i}{\bm m}, \frac{\bm i+1}{\bm m}\right].\]</p><p>Furthermore, for any copula <span>$C$</span> (or more generally distribution function <span>$F$</span>), we denote <span>$\mu_{C}$</span> (resp <span>$\mu_F$</span>) the associated measure.  For example, for the independence copula <span>$Pi$</span>, <span>$\mu_{\Pi}(A) = \lambda(A \cup [\bm 0, \bm 1])$</span> where <span>$\lambda$</span> is the Lebesgue measure.</p><blockquote><p><strong>Definition (Empirical Checkerboard copulas [<a href="../references/#cuberos2019">41</a>]):</strong> Let <span>$\bm m \in \mathbb N^d$</span>. The <span>$\bm m$</span>-Checkerboard copula <span>$\hat{C}_{N,\bm m}$</span>, defined by </p><p class="math-container">\[\hat{C}_{N,\bm m}(\bm x) = \bm m^{\bm 1} \sum_{\bm i &lt; \bm m} \mu_{\hat{C}_N}(B_{\bm i, \bm m}) \mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x])\]</p><p>s a genuine copula as soon as <span>$m_1,...,m_d$</span> all divide <span>$N$</span>.</p></blockquote><blockquote><p><strong>Property (Consistency of <span>$\hat{C}_{N,\bm m}$</span> [<a href="../references/#cuberos2019">41</a>]):</strong> If all <span>$m_1,..,m_d$</span> divide <span>$N$</span>, </p><p class="math-container">\[\sup\limits_{\bm u \in [0,1]^d} \lvert \hat{C}_{N,\bm m}(\bm u) - C(\bm u) \rvert \le \frac{d}{2m} + \mathcal O_{\mathbb P}\left(n^{-\frac{1}{2}}\right).\]</p></blockquote><p>This copula is called <em>Checkerboard</em>, as it fills the unit hypercube with hyperrectangles of same shapes <span>$B_{\bm i, \bm m}$</span>, conditionally on which the distribution is uniform, and the mixing weights are the empirical frequencies of the hyperrectangles. </p><p>It can be noted that there is no need for the hyperrectangles to be filled with a uniform distribution (<span>$\mu_{\Pi}$</span>), as soon as they are filled with copula measures and weighted according to the empirical measure in them (or to any other copula). The direct extension is then the more general patchwork copulas, whose construction is detailed below.</p><p>Denoting <span>$B_{\bm i, \bm m}(\bm x) = B_{\bm i, \bm m} \cap [0,\bm x]$</span>, we have : </p><p class="math-container">\[\begin{align}
  m^d\mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x]) &amp;= \frac{\mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x])}{\mu_{\Pi}(B_{\bm i, \bm m})}\\
  &amp;= \frac{\mu_{\Pi}(B_{\bm i, \bm m}(\bm x))}{\mu_{\Pi}(B_{\bm i, \bm m})}\\
  &amp;= \mu_{\Pi}(\bm m B_{\bm i, \bm m}(\bm x))
\end{align}\]</p><p>where we intend <span>$\bm m ]\bm a, \bm b] = ] \bm m \bm a, \bm m \bm b]$</span> (recall that products between vectors are componentwise).</p><p>This allows for an easy generalization in the framework of patchwork copulas: </p><blockquote><p><strong>Definition (Patchwork copulas [<a href="../references/#durante2012">43</a>–<a href="../references/#durante2015">45</a>]):</strong> Let <span>$\bm m \in \mathbb N^d$</span> all divide <span>$N$</span>, and let <span>$\mathcal C = \{C_{\bm i}, \bm i &lt; \bm m\}$</span> be a given collection of copulas. The distribution function</p><p class="math-container">\[\hat{C}_{N,\bm m, \mathcal C}(\bm x) = \sum_{\bm i &lt; \bm m} \mu_{\hat{C}_N}(B_{\bm i, \bm m}) \mu_{C_{\bm i}}(\bm m B_{\bm i, \bm m}(\bm x))\]</p><p>is a copula. </p></blockquote><p>In fact, replacing <span>$\hat{C}_N$</span> by any copula in Definition \ref{intro:def:patchwork} still yields a genuine copula, with no more conditions that all components of <span>$\bm m$</span> divide <span>$N$</span>. The Checkerboard grids are practical in the sense that computations associated to a Checkerboard copula can be really fast: if the grid is large, the number of boxes is small, and otherwise if the grid is very refined, many boxes are probably empty. On the other hand, the grid is fixed a priori. There exists potential extensions to adaptative grids, see e.g. [<a href="../references/#laverny2020">46</a>].</p><p>Convergence results for this kind of copulas can be found in [<a href="../references/#durante2015">45</a>], with a slightly different parametrization. </p><p>One more noticeable class of copulas are the Vines copulas. These distributions use a graph of conditional distributions to encode the distribution of the random vector. To define such a model, working with conditional densities, and given any ordered partition <span>$\bm i_1,...\bm i_p$</span> of <span>$1,...d$</span>, we write </p><p class="math-container">\[f(\bm x) = f(x_{\bm i_1}) \prod\limits_{j=1}^{p-1} f(x_{\bm i_{j+1}} | x_{\bm i_j}).\]</p><p>Of course, the choice of the partition, of its order, and of the conditional models is left to the practitioner. The goal when dealing with such dependency graphs is to tailor the graph to reduce the error of approximation, which can be a tricky task. There exists simplifying assumptions that help with this matter, and we refer to [<a href="../references/#czado2019">7</a>, <a href="../references/#nagler2016">37</a>, <a href="../references/#nagler2018">38</a>, <a href="../references/#durante2017a">47</a>–<a href="../references/#graler2014">49</a>] for a deep dive into the vine theory, along with some nice results and extensions. </p><p>Although the copula is an object that summarizes completely the dependence structure of any random vector, it is an infinite dimensional object and the interpretation of its properties can be difficult when the dimension gets high. Therefore, the literature has come up with some quantifications of the dependence structure that might be used as univariate summaries, of course imperfect, of certain properties of the copula at hand. </p><p>We now define measures of dependency level.</p><blockquote><p><strong>Definition (Kendall&#39;s <span>$\tau$</span> and Spearman&#39;s <span>$\rho$</span>):</strong> For a copula <span>$C$</span> with a density <span>$c$</span>, we define:</p><p class="math-container">\[\tau = 4 \int C(\bm u) \, c(\bm u) \;d\bm u -1\]</p><p class="math-container">\[\rho &amp;= 12 \int C(\bm u) d\bm u -3.\]</p></blockquote><p>Kendall&#39;s <span>$\tau$</span> and Spearman&#39;s <span>$\rho$</span> have values between -1 and 1, and are -1 in case of complete anticonomotony and 1 in case of comonotony. Moreover, they are 0 in case of independence. This is why we say that they measure the &#39;strength&#39; of the dependency. They make more sense in the bivariate case than in other cases, and therefore we sometimes refer to the Kendall&#39;s matrix or the Spearman&#39;s matrix for the collection of bivariate coefficients associated to a multivariate copula. Many copula estimators are based on these coefficients, see e.g., [<a href="../references/#genest2011">50</a>, <a href="../references/#fredricks2007">51</a>].</p><p>There are also tail coefficients: </p><blockquote><p><strong>Definition (Upper tail dependency):</strong> For a copula <span>$C$</span>, we define (when they exist):</p><p class="math-container">\[\lambda = \lim\limits_{u \to 1} \frac{1 - 2u - C(u,..,u)}{1- u} \in [0,1]\]</p><p class="math-container">\[\chi(u) = \frac{2 \ln(1-u)}{\ln(1-2u-C(u,...,u))} -1\]</p><p class="math-container">\[\chi = \lim\limits_{u \to 1} \chi(u) \in [-1,1]\]</p><p>When <span>$\lambda &gt; 0$</span>, we say that there is a strong upper tail dependency, and <span>$\chi = 1$</span>. When <span>$\lambda = 0$</span>, we say that there is no strong upper tail dependency, and if furthermore <span>$\chi \neq 0$</span> we say that there is weak upper tail dependency.</p></blockquote><p>The graph of <span>$u \to \chi(u)$</span> over <span>$[\frac{1}{2},1]$</span> is an interesting tool to assess the existence and strength of the tail dependency. The same kind of tools can be constructed for the lower tail. </p><p>All these coefficients are useful to quantify the behavior of the dependence structure, both generally and in the extremes, and are therefore widely used in the literature either as verification tools to assess the quality of fits, or even as parameters. Many parametric copulas families have simple surjections, injections, or even bijections between these coefficients and their parametrizations, allowing matching procedures of estimation (a lot like moments matching algorithm for fitting standard random variables). </p><p>There would have been many more things to say about dependence structures and copulas. This short literature review, however, seems enough to understand the matters of this package. We refer the interested reader to the numerous references.</p><div class="citation noncanonical"><dl><dt>[1]</dt><dd><div>H. Joe. <em>Multivariate Models and Multivariate Dependence Concepts</em> (CRC press, 1997).</div></dd><dt>[2]</dt><dd><div>U. Cherubini, E. Luciano and W. Vecchiato. <em>Copula Methods in Finance</em> (John Wiley &amp; Sons, 2004).</div></dd><dt>[3]</dt><dd><div>R. B. Nelsen. <em>An Introduction to Copulas</em>. 2nd ed Edition, <em>Springer Series in Statistics</em> (Springer, New York, 2006).</div></dd><dt>[4]</dt><dd><div>H. Joe. <em>Dependence Modeling with Copulas</em> (CRC press, 2014).</div></dd><dt>[5]</dt><dd><div>J.-F. Mai, M. Scherer and C. Czado. <em>Simulating Copulas: Stochastic Models, Sampling Algorithms, and Applications</em>. 2nd edition Edition, Vol. 6 of <em>Series in Quantitative Finance</em> (World Scientific, New Jersey, 2017).</div></dd><dt>[6]</dt><dd><div>F. Durante and C. Sempi. <em>Principles of Copula Theory</em> (Chapman and Hall/CRC, 2015).</div></dd><dt>[7]</dt><dd><div>C. Czado. <em>Analyzing Dependent Data with Vine Copulas: A Practical Guide With R</em>. Vol. 222 of <em>Lecture Notes in Statistics</em> (Springer International Publishing, Cham, 2019).</div></dd><dt>[8]</dt><dd><div>J. Größer and O. Okhrin. <em>Copulae: An Overview and Recent Developments</em>. WIREs Computational Statistics (2021).</div></dd><dt>[9]</dt><dd><div>A. Sklar. <em>Fonctions de Repartition à n Dimension et Leurs Marges</em>. Université Paris <strong>8</strong>, 1–3 (1959).</div></dd><dt>[10]</dt><dd><div>T. Lux and A. Papapantoleon. <em>Improved Fréchet-Hoeffding Bounds on <span>$d$</span>-Copulas and Applications in Model-Free Finance</em>, arXiv:1602.08894 <a href="2017">math, q-fin</a>.</div></dd><dt>[11]</dt><dd><div>R. Kaas, J. Dhaene, D. Vyncke, M. J. Goovaerts and M. Denuit. <em>A Simple Geometric Proof That Comonotonic Risks Have the Convex-Largest Sum</em>. ASTIN Bulletin: The Journal of the IAA <strong>32</strong>, 71–80 (2002).</div></dd><dt>[12]</dt><dd><div>L. Hua and H. Joe. <em>Multivariate Dependence Modeling Based on Comonotonic Factors</em>. Journal of Multivariate Analysis <strong>155</strong>, 317–333 (2017).</div></dd><dt>[13]</dt><dd><div>G. Frahm, M. Junker and A. Szimayer. <em>Elliptical Copulas: Applicability and Limitations</em>. Statistics &amp; Probability Letters <strong>63</strong>, 275–286 (2003).</div></dd><dt>[14]</dt><dd><div>E. Gómez, M. A. Gómez-villegas and J. M. Marín. <em>A Survey on Continuous Elliptical Vector Distributions</em>. Revista Matemática Complutense <strong>16</strong>, 345–361 (2003).</div></dd><dt>[15]</dt><dd><div>M.-P. Côté and C. Genest. <em>Dependence in a Background Risk Model</em>. Journal of Multivariate Analysis <strong>172</strong>, 28–46 (2019).</div></dd><dt>[16]</dt><dd><div>A. Derumigny and J.-D. Fermanian. <em>Identifiability and Estimation of Meta-Elliptical Copula Generators</em>. Journal of Multivariate Analysis, 104962 (2022).</div></dd><dt>[17]</dt><dd><div>A. J. McNeil and J. Nešlehová. <em>Multivariate Archimedean Copulas, d -Monotone Functions and L1 -Norm Symmetric Distributions</em>. The Annals of Statistics <strong>37</strong>, 3059–3097 (2009).</div></dd><dt>[18]</dt><dd><div>A. J. McNeil. <em>Sampling Nested Archimedean Copulas</em>. Journal of Statistical Computation and Simulation <strong>78</strong>, 567–581 (2008).</div></dd><dt>[19]</dt><dd><div>M. Hofert, M. Mächler and A. J. McNeil. <em>Archimedean Copulas in High Dimensions: Estimators and Numerical Challenges Motivated by Financial Applications</em>. Journal de la Société Française de Statistique <strong>154</strong>, 25–63 (2013).</div></dd><dt>[20]</dt><dd><div>M. Hofert. <em>Sampling Nested Archimedean Copulas with Applications to CDO Pricing</em>. Ph.D. Thesis, Universität Ulm (2010).</div></dd><dt>[21]</dt><dd><div>M. Hofert and D. Pham. <em>Densities of Nested Archimedean Copulas</em>. Journal of Multivariate Analysis <strong>118</strong>, 37–52 (2013).</div></dd><dt>[22]</dt><dd><div>A. J. McNeil and J. Nešlehová. <em>From Archimedean to Liouville Copulas</em>. Journal of Multivariate Analysis <strong>101</strong>, 1772–1790 (2010).</div></dd><dt>[23]</dt><dd><div>H. Cossette, S.-P. Gadoury, E. Marceau and I. Mtalai. <em>Hierarchical Archimedean Copulas through Multivariate Compound Distributions</em>. Insurance: Mathematics and Economics <strong>76</strong>, 1–13 (2017).</div></dd><dt>[24]</dt><dd><div>H. Cossette, E. Marceau, I. Mtalai and D. Veilleux. <em>Dependent Risk Models with Archimedean Copulas: A Computational Strategy Based on Common Mixtures and Applications</em>. Insurance: Mathematics and Economics <strong>78</strong>, 53–71 (2018).</div></dd><dt>[25]</dt><dd><div>C. Genest, J. Nešlehová and J. Ziegel. <em>Inference in Multivariate Archimedean Copula Models</em>. TEST <strong>20</strong>, 223–256 (2011).</div></dd><dt>[26]</dt><dd><div>E. Di Bernardino and D. Rulliere. <em>On Certain Transformations of Archimedean Copulas: Application to the Non-Parametric Estimation of Their Generators</em>. Dependence Modeling <strong>1</strong>, 1–36 (2013).</div></dd><dt>[27]</dt><dd><div>E. Di Bernardino and D. Rullière. <em>On an Asymmetric Extension of Multivariate Archimedean Copulas Based on Quadratic Form</em>. Dependence Modeling <strong>4</strong> (2016).</div></dd><dt>[28]</dt><dd><div>K. Cooray. <em>Strictly Archimedean Copulas with Complete Association for Multivariate Dependence Based on the Clayton Family</em>. Dependence Modeling <strong>6</strong>, 1–18 (2018).</div></dd><dt>[29]</dt><dd><div>J. Spreeuw. <em>Archimedean Copulas Derived from Utility Functions</em>. Insurance: Mathematics and Economics <strong>59</strong>, 235–242 (2014).</div></dd><dt>[30]</dt><dd><div>W. Zhu, K. S. Tan and C.-W. Wang. <em>Modeling Multicountry Longevity Risk With Mortality Dependence: A Lévy Subordinated Hierarchical Archimedean Copulas Approach: Modeling Multicountry Longevity Risk with Mortality Dependence</em>. Journal of Risk and Insurance <strong>84</strong>, 477–493 (2017).</div></dd><dt>[31]</dt><dd><div>N. Uyttendaele. <em>On the Estimation of Nested Archimedean Copulas: A Theoretical and an Experimental Comparison</em>. Computational Statistics <strong>33</strong>, 1047–1070 (2018).</div></dd><dt>[32]</dt><dd><div>R. T. Steck. <em>Time-Varying Hierarchical Archimedean Copulas Using Adaptively Simulated Critical Values</em>. Ph.D. Thesis, Humboldt-Universität zu Berlin, Wirtschaftswissenschaftliche Fakultät (2015).</div></dd><dt>[33]</dt><dd><div>J. Górecki, M. Hofert and M. Holeňa. <em>On Structure, Family and Parameter Estimation of Hierarchical Archimedean Copulas</em>, arXiv:1611.09225 <a href="2016">stat</a>.</div></dd><dt>[34]</dt><dd><div>J. Górecki, M. Hofert and M. Holeňa. <em>Kendall&#39;s Tau and Agglomerative Clustering for Structure Determination of Hierarchical Archimedean Copulas</em>. Dependence Modeling <strong>5</strong>, 75–87 (2017).</div></dd><dt>[35]</dt><dd><div>H. Cossette, E. Marceau and I. Mtalai. <em>Collective Risk Models with Hierarchical Archimedean Copulas</em>. SSRN Electronic Journal (2018).</div></dd><dt>[36]</dt><dd><div>D. Müller and C. Czado. <em>Representing Sparse Gaussian DAGs as Sparse R-vines Allowing for Non-Gaussian Dependence</em>. Journal of Computational and Graphical Statistics <strong>27</strong>, 334–344 (2018).</div></dd><dt>[37]</dt><dd><div>T. Nagler and C. Czado. <em>Evading the Curse of Dimensionality in Nonparametric Density Estimation with Simplified Vine Copulas</em>. Journal of Multivariate Analysis <strong>151</strong>, 69–89 (2016).</div></dd><dt>[38]</dt><dd><div>T. Nagler. <em>Nonparametric Estimation in Simplified Vine Copula Models</em>. Ph.D. Thesis, Technische Universität München (2018).</div></dd><dt>[39]</dt><dd><div>P. Deheuvels. <em>La Fonction de Dépendance Empirique et Ses Propriétés. Académie Royale de Belgique</em>. Bulletin de la Classe des Sciences <strong>65</strong>, 274–292 (1979).</div></dd><dt>[40]</dt><dd><div>J. Segers, M. Sibuya and H. Tsukahara. <em>The Empirical Beta Copula</em>. Journal of Multivariate Analysis <strong>155</strong>, 35–51 (2017).</div></dd><dt>[41]</dt><dd><div>A. Cuberos, E. Masiello and V. Maume-Deschamps. <em>Copulas Checker-Type Approximations: Application to Quantiles Estimation of Sums of Dependent Random Variables</em>. Communications in Statistics - Theory and Methods, 1–19 (2019).</div></dd><dt>[42]</dt><dd><div>P. Mikusiński and M. D. Taylor. <em>Some Approximations of N-Copulas</em>. Metrika <strong>72</strong>, 385–414 (2010).</div></dd><dt>[43]</dt><dd><div>F. Durante, E. Foscolo, J. A. Rodríguez-Lallena and M. Úbeda-Flores. <em>A Method for Constructing Higher-Dimensional Copulas</em>. Statistics <strong>46</strong>, 387–404 (2012).</div></dd><dt>[44]</dt><dd><div>F. Durante, J. Fernández Sánchez and C. Sempi. <em>Multivariate Patchwork Copulas: A Unified Approach with Applications to Partial Comonotonicity</em>. Insurance: Mathematics and Economics <strong>53</strong>, 897–905 (2013).</div></dd><dt>[45]</dt><dd><div>F. Durante, J. Fernández-Sánchez, J. J. Quesada-Molina and M. Úbeda-Flores. <em>Convergence Results for Patchwork Copulas</em>. European Journal of Operational Research <strong>247</strong>, 525–531 (2015).</div></dd><dt>[46]</dt><dd><div>O. Laverny. <em>Empirical and Non-Parametric Copula Models with the Cort R Package</em>. Journal of Open Source Software <strong>5</strong>, 2653 (2020).</div></dd><dt>[47]</dt><dd><div>F. Durante, G. Puccetti, M. Scherer and S. Vanduffel. <em>The Vine Philosopher</em>. Dependence Modeling <strong>5</strong>, 256–267 (2017).</div></dd><dt>[48]</dt><dd><div>C. Czado, S. Jeske and M. Hofmann. <em>Selection Strategies for Regular Vine Copulae</em>. Journal de la Société Française de Statistique <strong>154</strong>, 174–191 (2013).</div></dd><dt>[49]</dt><dd><div>B. Gräler. <em>Modelling Skewed Spatial Random Fields through the Spatial Vine Copula</em>. Spatial Statistics <strong>10</strong>, 87–102 (2014).</div></dd><dt>[50]</dt><dd><div>C. Genest, J. Nešlehová and N. Ben Ghorbal. <em>Estimators Based on Kendall&#39;s Tau in Multivariate Copula Models</em>. Australian &amp; New Zealand Journal of Statistics <strong>53</strong>, 157–177 (2011).</div></dd><dt>[51]</dt><dd><div>G. A. Fredricks and R. B. Nelsen. <em>On the Relationship between Spearman&#39;s Rho and Kendall&#39;s Tau for Pairs of Continuous Random Variables</em>. Journal of Statistical Planning and Inference <strong>137</strong>, 2143–2150 (2007).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../sklar/">Sklar&#39;s Theorem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 21 November 2023 16:46">Tuesday 21 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
