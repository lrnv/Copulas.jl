<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Discussion · Copulas.jl</title><meta name="title" content="General Discussion · Copulas.jl"/><meta property="og:title" content="General Discussion · Copulas.jl"/><meta property="twitter:title" content="General Discussion · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/archimedean/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Copulas.jl package</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../theoretical_background/">Theoretical Background</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Theorem</a></li><li><span class="tocitem">Elliptical Copulas</span><ul><li><a class="tocitem" href="../../elliptical/generalities/">General Discussion</a></li><li><a class="tocitem" href="../../elliptical/available_models/">Available elliptical copulas</a></li></ul></li><li><span class="tocitem">Archimedean Copulas</span><ul><li class="is-active"><a class="tocitem" href>General Discussion</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Implement-your-own"><span>Implement your own</span></a></li></ul></li><li><a class="tocitem" href="../generators/">Archimedean Generators</a></li><li><a class="tocitem" href="../available_models/">Available Archimedean models</a></li></ul></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><span class="tocitem">Exemples</span><ul><li><a class="tocitem" href="../../exemples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../exemples/turing/">Bayesian inference with Turing.jl</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Archimedean Copulas</a></li><li class="is-active"><a href>General Discussion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Discussion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/archimedean/generalities.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="General-Discussion"><a class="docs-heading-anchor" href="#General-Discussion">General Discussion</a><a id="General-Discussion-1"></a><a class="docs-heading-anchor-permalink" href="#General-Discussion" title="Permalink"></a></h1><p>Archimedean copulas are a large class of copulas that are defined as : ... [ details needed...]</p><p>In our implementation, we separate the generator, in the <code>Generator</code> type, from the copula itself. The easyest way to understand this orthogonal design is to look at the Clayton implementation. </p><p>We have the <code>ClaytonGenerator</code> that is defined as follows: </p><pre><code class="language-julia hljs">struct ClaytonGenerator{T} &lt;: UnivariateGenerator
    θ::T
    function ClaytonGenerator(θ)
        if θ &lt; -1
            throw(ArgumentError(&quot;Theta must be greater than -1&quot;))
        elseif θ == -1
            return WGenerator()
        elseif θ == 0
            return IndependentGenerator()
        elseif θ == Inf
            return MGenerator()
        else
            return new{typeof(θ)}(θ)
        end
    end
end
max_monotony(G::ClaytonGenerator) = G.θ &gt;= 0 ? Inf : Int(floor(1 - 1/G.θ))
ϕ(  G::ClaytonGenerator, t) = max(1+G.θ*t,zero(t))^(-1/G.θ)
ϕ⁻¹(G::ClaytonGenerator, t) = (t^(-G.θ)-1)/G.θ
# ϕ⁽¹⁾(G::ClaytonGenerator, t) =  First derivative of ϕ
# ϕ⁽ᵏ⁾(G::ClaytonGenerator, k, t) = kth derivative of ϕ
τ(G::ClaytonGenerator) = ifelse(isfinite(G.θ), G.θ/(G.θ+2), 1)
τ⁻¹(::Type{T},τ) where T&lt;:ClaytonGenerator = ifelse(τ == 1,Inf,2τ/(1-τ))
williamson_dist(G::ClaytonGenerator, d) = G.θ &gt;= 0 ? WilliamsonFromFrailty(Distributions.Gamma(1/G.θ,G.θ),d) : ClaytonWilliamsonDistribution(G.θ,d)</code></pre><p>And then the <code>ClaytonCopula{d,T}</code> is simply an alias for <code>ArchimedeanCopula{d,ClaytonGenerator{T}}</code>: </p><pre><code class="language-julia hljs">const ClaytonCopula{d,T} = ArchimedeanCopula{d,ClaytonGenerator{T}}
ClaytonCopula(d,θ) = ArchimedeanCopula(d,ClaytonGenerator(θ))
generatorof(::Type{ClaytonCopula}) = ClaytonGenerator</code></pre><p>Not everything is necessary however, depending on the features you need. Indeed, the Archimedean API is modular: </p><ul><li>Only <code>ϕ</code> and <code>max_monotony</code> are really required. Indeed, all other functions have generic fallbacks. In particular, the <code>williamson_dist</code> has a generic fallback that uses <a href="https://www.github.com/lrnv/WilliamsonTransforms.jl">WilliamsonTransforms.jl</a> for any generator. Note however that providing the <code>williamson_dist</code> yourself if you know it will allow sampling to be an order of magnitude faster: see how in the ClaytonCopula case we provided a sampler that is different for positive parameters (the generator is completely monotonous, and thus the frailty distribution is known, so we used <code>WilliamsonFromFrailty</code>), and the negative dependent cases, where only the CDF is known and implemented in <code>ClaytonWilliamsonDistribution</code>.</li><li>To evaluate the cdf and (log-)density in any dimension, only <code>ϕ</code> and <code>ϕ⁻¹</code> are needed.</li><li>Currently, to fit the copula <code>τ⁻¹</code> is needed as we use the inverse tau moment method. But we plan on also implementing inverse rho and MLE (density needed). </li><li>Note that the generator <code>ϕ</code> follows the convention <code>ϕ(0)=1</code>, while others (e.g., https://en.wikipedia.org/wiki/Copula<em>(probability</em>theory)#Archimedean_copulas) use <code>ϕ⁻¹</code> as the generator.</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.ArchimedeanCopula" href="#Copulas.ArchimedeanCopula"><code>Copulas.ArchimedeanCopula</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ArchimedeanCopula{d, TG}</code></pre><p>Fields:      - G::TG : the generator &lt;: Generator. </p><p>Constructor: </p><pre><code class="nohighlight hljs">ArchimedeanCopula(d::Int,G::Generator)</code></pre><p>For some archimedean generator <code>G::Generator</code> and some dimenson <code>d</code>, this class models the archimedean copula wich has this generator. More formally, a <span>$d$</span>-monotone archimedean generator is a function <span>$\phi$</span> on <span>$\mathbb R_+$</span> that has these three properties:</p><ul><li><span>$\phi(0) = 1$</span> and <span>$\phi(Inf) = 0$</span></li><li><span>$\phi$</span> is <span>$d-2$</span> times derivable, and the signs of its derivatives alternates : <span>$\forall k \in 0,...,d-2, (-1)^k \phi^{(k)} \ge 0$</span>.</li><li><span>$\phi^{(d-2)}$</span> is convex.</li></ul><p>In the code, this function is implemented as <code>ϕ(G::Generator,t)</code>, and its max monotony <code>d</code> is given by <code>max_monotony(G)</code>. The corresponding d-variate archimedean copula writes: </p><p class="math-container">\[C(\mathbf u) = \phi^{-1}\left(\sum_{i=1}^d \phi(u_i)\right)\]</p><p>It can be sampled through A Radial simplex decomposition as follows: If <span>$\mathbf U \sim C$</span>, then <span>$U \equal R \mathbf S$</span> for a random vector <span>$\mathbf S \sim$</span> <code>Dirichlet(ones(d))</code>, that is uniformity on the d-variate simplex, and a non-negative random variable <span>$R$</span> that is the Williamson d-transform of <code>\phi</code>. The density, cdf, kendall tau, and may other properties of the Archimedean copula are then directly deduced from this relationship. </p><p>There exists several known parametric generators that are implement in the package. For every <code>NamedGenerator &lt;: Generator</code> implemented in the package, we provide a type alias `<code>NamedCopula{d,...} = ArchimedeanCopula{d,NamedGenerator{...}}</code> to be able to manipulate the archimedean copulas without too much hassle for known and usefull special cases. </p><p>A generic archimdeanc copula can be constructed as follows: </p><pre><code class="language-julia hljs">struct MyGenerator &lt;: Generator end
ϕ(G::MyGenerator,t) = exp(-t) # your archimedean generator, can be any d-monotonous function.
max_monotony(G::MyGenerator) = Inf # could depend on generators parameters. 
C = ArchimedeanCopula(d,MyGenerator())</code></pre><p>The obtained model can be used as follows: </p><pre><code class="language-julia hljs">spl = rand(C,1000)   # sampling
cdf(C,spl)           # cdf
pdf(C,spl)           # pdf
loglikelihood(C,spl) # llh</code></pre><p>The following functions have defaults but can be overridden for performance: </p><pre><code class="language-julia hljs">ϕ⁻¹(C::MyArchimedean, t)        # Inverse of ϕ
ϕ⁽¹⁾(C::MyArchimedean, t)       # first defrivative of ϕ
ϕ⁽ᵈ⁾(C::MyArchimedean,t)        # dth defrivative of ϕ
τ(C::MyArchimedean)             # Kendall tau
τ⁻¹(::Type{MyArchimedean},τ) =  # Inverse kendall tau
fit(::Type{MyArchimedean},data) # fitting.</code></pre><p>As a bonus, If you know the williamson d-transform of your generator and not your generator itself, you may take a look at <a href="../generators/#Copulas.WilliamsonGenerator"><code>WilliamsonGenerator</code></a> that implements them. If you rather know the frailty distribution, take a look at <code>WilliamsonFromFrailty</code>.</p><p>References:      Williamson, R. E. (1956). Multiply monotone functions and their Laplace transforms. Duke Math. J. 23 189–207. MR0077581     McNeil, Alexander J., and Johanna Nešlehová. &quot;Multivariate Archimedean copulas, d-monotone functions and ℓ 1-norm symmetric distributions.&quot; (2009): 3059-3097.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/061773bfd669f1c282e6b5234990a2c10d367046/src/ArchimedeanCopula.jl#L1-L59">source</a></section></article><h1 id="Implement-your-own"><a class="docs-heading-anchor" href="#Implement-your-own">Implement your own</a><a id="Implement-your-own-1"></a><a class="docs-heading-anchor-permalink" href="#Implement-your-own" title="Permalink"></a></h1><p>If you think that the WilliamsonCopula interface is too barebone and does not provide you with enough flexibility in your modeling of an archimedean copula, you might be intersted in the possiiblity to directly subtype <code>ArchimedeanCopula</code> and implement your own. This is actually a fairly easy process and you only need to implement a few functions. Let&#39;s here together try to reimplement come archimedean copula with the follçowing generator: </p><p class="math-container">\[my_generator\]</p><p>(describe the process...)</p><pre><code class="language-julia hljs">struct MyAC{d,T} &lt;: ArchimedeanCopula{d}
    par::T
end
ϕ(C::MyAC{d},x)
ϕ⁻¹(C::MyAC{d},x)
τ(C::MyAC{d})
τ⁻¹(::MyAC{d},τ)
williamson_dist(C::MyAC{d})</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../elliptical/available_models/">« Available elliptical copulas</a><a class="docs-footer-nextpage" href="../generators/">Archimedean Generators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 21 November 2023 16:46">Tuesday 21 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
