<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Discussion · Copulas.jl</title><meta name="title" content="General Discussion · Copulas.jl"/><meta property="og:title" content="General Discussion · Copulas.jl"/><meta property="twitter:title" content="General Discussion · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/empirical/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/empirical/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/empirical/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Copulas.jl package</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><span class="tocitem">Elliptical Copulas</span><ul><li><a class="tocitem" href="../../elliptical/generalities/">General Discussion</a></li><li><a class="tocitem" href="../../elliptical/available_models/">Available models</a></li></ul></li><li><span class="tocitem">Archimedean Copulas</span><ul><li><a class="tocitem" href="../../archimedean/generalities/">General Discussion</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Available Models</a></li></ul></li><li><a class="tocitem" href="../../Liouville/">Liouville Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li><li><span class="tocitem">Empirical Copulas</span><ul><li class="is-active"><a class="tocitem" href>General Discussion</a><ul class="internal"><li><a class="tocitem" href="#Pseudo-observations"><span>Pseudo-observations</span></a></li><li><a class="tocitem" href="#Deheuvel&#39;s-empirical-copula"><span>Deheuvel&#39;s empirical copula</span></a></li><li><a class="tocitem" href="#Beta-copula"><span>Beta copula</span></a></li><li><a class="tocitem" href="#Bernstein-Copula"><span>Bernstein Copula</span></a></li><li><a class="tocitem" href="#Checkerboard-Copulas"><span>Checkerboard Copulas</span></a></li></ul></li><li><a class="tocitem" href="../available_models/">Available Models</a></li></ul></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li><li><span class="tocitem">Exemples</span><ul><li><a class="tocitem" href="../../exemples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../exemples/turing/">Bayesian inference with Turing.jl</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Empirical Copulas</a></li><li class="is-active"><a href>General Discussion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Discussion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/empirical/generalities.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="General-Discussion"><a class="docs-heading-anchor" href="#General-Discussion">General Discussion</a><a id="General-Discussion-1"></a><a class="docs-heading-anchor-permalink" href="#General-Discussion" title="Permalink"></a></h1><h2 id="Pseudo-observations"><a class="docs-heading-anchor" href="#Pseudo-observations">Pseudo-observations</a><a id="Pseudo-observations-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudo-observations" title="Permalink"></a></h2><p>Through the statistical process leading to the estimation of copulas, one usually observes the data and information on the marginals scale and not on the copula scale. This discrepancy between the observed information and the modeled distribution must be taken into account. A key concept is that of pseudo-observations. </p><blockquote><p><strong>Definition (Pseudo-observations):</strong> If <span>$\bm x \in \mathbb R^{N\times d}$</span> is an <span>$N$</span>-sample of a <span>$d$</span>-variate real-valued random vector <span>$\bm X$</span>, then the pseudo-observations are the normalized ranks of the marginals of <span>$\bm x$</span>, defined as : </p><p class="math-container">\[\bm u \in \mathbb [0,1]^{N\times d}:\; u_{i,j} = \frac{\mathrm{Rank}(x_{i,j},\,\bm x_{\cdot,j})}{N+1} = \frac{1}{N+1}\sum_{k=1}^N \mathbb 1_{x_{k,j} \le x_{i,j}},\]</p><p>where <span>$\mathrm{Rank}(y,\bm x)  = \sum\limits_{x_i \in \bm x} \mathbb 1_{x_i \le y}$</span>.</p></blockquote><p>In <code>Copulas.jl</code>, we provide a function <code>pseudos</code> that implement this transformation directly. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.pseudos" href="#Copulas.pseudos"><code>Copulas.pseudos</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pseudos(sample)</code></pre><p>Compute the pseudo-observations of a multivariate sample. Note that the sample has to be given in wide format (d,n), where d is the dimension and n the number of observations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/32d1ac56383f9da386f05d3992c6fe518e447125/src/utils.jl#L1-L5">source</a></section></article><h2 id="Deheuvel&#39;s-empirical-copula"><a class="docs-heading-anchor" href="#Deheuvel&#39;s-empirical-copula">Deheuvel&#39;s empirical copula</a><a id="Deheuvel&#39;s-empirical-copula-1"></a><a class="docs-heading-anchor-permalink" href="#Deheuvel&#39;s-empirical-copula" title="Permalink"></a></h2><p>From these pseudo-observations, an empirical copula is defined as follows:</p><blockquote><p><strong>Definition (Deheuvel&#39;s empirical copula [<a href="../../references/#deheuvels1979">13</a>]):</strong> The empirical distribution function of the normalized ranks,</p><p class="math-container">\[\hat{C}_N(\bm u) = \frac{1}{N} \sum_{i=1}^N \mathbb 1_{\bm u_i \le \bm u},\]</p><p>is called the empirical copula function.</p></blockquote><blockquote><p><strong>Theorem (Exhaustivity and consistency [<a href="../../references/#deheuvels1979">13</a>]):</strong> <span>$\hat{C}_N$</span> is an exhaustive estimator of <span>$C$</span>, and moreover for any normalizing constants <span>$\{\phi_N, N\in \mathbb N\}$</span> such that <span>$\lim\limits_{N \to \infty} \phi_N \sqrt{N^{-1}\ln \ln N} = 0$</span>, </p><p class="math-container">\[\lim\limits_{N\to\infty} \phi_N \sup_{\bm u \in [0,1]^d} \lvert\hat{C}_N(\bm u) - C(\bm u) \rvert = 0 \text{ a.s.}\]</p></blockquote><p class="math-container">\[\hat{C}_N\]</p><p>then converges (weakly) to <span>$C$</span>, the true copula of the random vector <span>$\bm X$</span>, when the number of observations <span>$N$</span> goes to infinity. </p><div class="admonition is-info"><header class="admonition-header">The empirical copula is not a true copula</header><div class="admonition-body"><p>Despite its name, <span>$\hat{C}_N$</span> is not a copula since it does not have uniform marginals. Be carrefull. </p></div></div><p>In the package, this copula is implemented as the <code>EmpiricalCopula</code>: </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.EmpiricalCopula-empirical-generalities" href="#Copulas.EmpiricalCopula-empirical-generalities"><code>Copulas.EmpiricalCopula</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EmpiricalCopula{d,MT}</code></pre><p>Fields:</p><ul><li>u::MT - the matrix of observations. </li></ul><p>Constructor</p><pre><code class="nohighlight hljs">EmpiricalCopula(u;pseudos=true)</code></pre><p>The EmpiricalCopula in dimension <span>$d$</span> is parameterized by a pseudo-data matrix wich should have shape (d,N). Its expression is given as :  </p><p class="math-container">\[C(\mathbf x) = \frac{1}{N}\sum_{i=1}^n \mathbf 1_{\mathbf u_i \le \mathbf x}\]</p><p>This function is very practical, be be aware that this is not a true copula (since <span>$\mathbf u$</span> are only pseudo-observations). The constructor allows you to pass dirctly pseudo-observations (the default) or will compute them for you. You can then compute the <code>cdf</code> of the copula, and sample it through the standard interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/32d1ac56383f9da386f05d3992c6fe518e447125/src/MiscellaneousCopulas/EmpiricalCopula.jl#L1-L18">source</a></section></article><h2 id="Beta-copula"><a class="docs-heading-anchor" href="#Beta-copula">Beta copula</a><a id="Beta-copula-1"></a><a class="docs-heading-anchor-permalink" href="#Beta-copula" title="Permalink"></a></h2><p>The empirical copula function is not a copula. An easy way to fix this problem is to smooth out the marginals with beta distribution functions: </p><blockquote><p><strong>Definition (Beta Copula [<a href="../../references/#segers2017">14</a>]):</strong> Denoting <span>$F_{n,r}(x) = \sum_{s=r}^n \binom{n}{s} x^s(1-x)^{n-s}$</span> the distribution function of a <span>$\mathrm{Beta}(r,n+1-r)$</span> random variable, the function</p><p class="math-container">\[\hat{C}_N^\beta : \bm x \mapsto \frac{1}{N} \sum_{i=1}^N \prod\limits_{j=1}^d F_{n,(N+1)u_{i,j}}(x_j)\]</p><p>is a genuine copula, called the Beta copula. </p></blockquote><blockquote><p><strong>Property (Proximity of <span>$\hat{C}_N$</span> and <span>$\hat{C}_N^\beta$</span> [<a href="../../references/#segers2017">14</a>]):</strong></p><p class="math-container">\[\sup\limits_{\bm u \in [0,1]^d} \lvert \hat{C}_N(\bm u) - \hat{C}_N^\beta(\bm u) \rvert \le d\left(\sqrt{\frac{\ln n}{n}} + \sqrt{\frac{1}{n}} + \frac{1}{n}\right)\]</p></blockquote><div class="admonition is-info"><header class="admonition-header">Not implemeted yet!</header><div class="admonition-body"><p>Do not hesitate to come talk on <a href="https://github.com/lrnv/Copulas.jl">our github</a> !</p></div></div><h2 id="Bernstein-Copula"><a class="docs-heading-anchor" href="#Bernstein-Copula">Bernstein Copula</a><a id="Bernstein-Copula-1"></a><a class="docs-heading-anchor-permalink" href="#Bernstein-Copula" title="Permalink"></a></h2><p>Bernstein copula are simply another smoothing of the empirical copula using Bernstein polynomials. </p><div class="admonition is-info"><header class="admonition-header">Not implemeted yet!</header><div class="admonition-body"><p>Do not hesitate to come talk on <a href="https://github.com/lrnv/Copulas.jl">our github</a> !</p></div></div><h2 id="Checkerboard-Copulas"><a class="docs-heading-anchor" href="#Checkerboard-Copulas">Checkerboard Copulas</a><a id="Checkerboard-Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Checkerboard-Copulas" title="Permalink"></a></h2><p>There are other nonparametric estimators of the copula function that are true copulas. Of interest to our work is the Checkerboard construction (see [<a href="../../references/#cuberos2019">15</a>, <a href="../../references/#mikusinski2010">16</a>]), detailed below.</p><p>First, for any <span>$\bm m \in \mathbb N^d$</span>, let <span>$\left\{B_{\bm i,\bm m}, \bm i &lt; \bm m\right\}$</span> be a partition of the unit hypercube defined by</p><p class="math-container">\[B_{\bm i, \bm m} = \left]\frac{\bm i}{\bm m}, \frac{\bm i+1}{\bm m}\right].\]</p><p>Furthermore, for any copula <span>$C$</span> (or more generally distribution function <span>$F$</span>), we denote <span>$\mu_{C}$</span> (resp <span>$\mu_F$</span>) the associated measure.  For example, for the independence copula <span>$Pi$</span>, <span>$\mu_{\Pi}(A) = \lambda(A \cup [\bm 0, \bm 1])$</span> where <span>$\lambda$</span> is the Lebesgue measure.</p><blockquote><p><strong>Definition (Empirical Checkerboard copulas [<a href="../../references/#cuberos2019">15</a>]):</strong> Let <span>$\bm m \in \mathbb N^d$</span>. The <span>$\bm m$</span>-Checkerboard copula <span>$\hat{C}_{N,\bm m}$</span>, defined by </p><p class="math-container">\[\hat{C}_{N,\bm m}(\bm x) = \bm m^{\bm 1} \sum_{\bm i &lt; \bm m} \mu_{\hat{C}_N}(B_{\bm i, \bm m}) \mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x]),\]</p><p>is a genuine copula as soon as <span>$m_1,...,m_d$</span> all divide <span>$N$</span>.</p></blockquote><blockquote><p><strong>Property (Consistency of <span>$\hat{C}_{N,\bm m}$</span> [<a href="../../references/#cuberos2019">15</a>]:</strong> If all <span>$m_1,..,m_d$</span> divide <span>$N$</span>,</p><p class="math-container">\[\sup\limits_{\bm u \in [0,1]^d} \lvert \hat{C}_{N,\bm m}(\bm u) - C(\bm u) \rvert \le \frac{d}{2m} + \mathcal O_{\mathbb P}\left(n^{-\frac{1}{2}}\right).\]</p></blockquote><p>This copula is called <em>Checkerboard</em>, as it fills the unit hypercube with hyperrectangles of same shapes <span>$B_{\bm i, \bm m}$</span>, conditionally on which the distribution is uniform, and the mixing weights are the empirical frequencies of the hyperrectangles. </p><p>It can be noted that there is no need for the hyperrectangles to be filled with a uniform distribution (<span>$\mu_{\Pi}$</span>), as soon as they are filled with copula measures and weighted according to the empirical measure in them (or to any other copula). The direct extension is then the more general patchwork copulas, whose construction is detailed below.</p><p>Denoting <span>$B_{\bm i, \bm m}(\bm x) = B_{\bm i, \bm m} \cap [0,\bm x]$</span>, we have : </p><p class="math-container">\[\begin{align}
  m^d\mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x]) &amp;= \frac{\mu_{\Pi}(B_{\bm i, \bm m} \cap [0,\bm x])}{\mu_{\Pi}(B_{\bm i, \bm m})}\\
  &amp;= \frac{\mu_{\Pi}(B_{\bm i, \bm m}(\bm x))}{\mu_{\Pi}(B_{\bm i, \bm m})}\\
  &amp;= \mu_{\Pi}(\bm m B_{\bm i, \bm m}(\bm x))
\end{align}\]</p><p>where we intend <span>$\bm m ]\bm a, \bm b] = ] \bm m \bm a, \bm m \bm b]$</span> (products between vectors are componentwise).</p><p>This allows for an easy generalization in the framework of patchwork copulas: </p><blockquote><p><strong>Definition (Patchwork copulas [<a href="../../references/#durante2012">17</a>–<a href="../../references/#durante2015">19</a>]:</strong>) Let <span>$\bm m \in \mathbb N^d$</span> all divide <span>$N$</span>, and let <span>$\mathcal C = \{C_{\bm i}, \bm i &lt; \bm m\}$</span> be a given collection of copulas. The distribution function</p><p class="math-container">\[\hat{C}_{N,\bm m, \mathcal C}(\bm x) = \sum_{\bm i &lt; \bm m} \mu_{\hat{C}_N}(B_{\bm i, \bm m}) \mu_{C_{\bm i}}(\bm m B_{\bm i, \bm m}(\bm x))\]</p><p>is a copula. </p></blockquote><p>In fact, replacing <span>$\hat{C}_N$</span> by any copula in the patchwork construct still yields a genuine copula, with no more conditions that all components of <span>$\bm m$</span> divide <span>$N$</span>. The Checkerboard grids are practical in the sense that computations associated to a Checkerboard copula can be really fast: if the grid is large, the number of boxes is small, and otherwise if the grid is very refined, many boxes are probably empty. On the other hand, the grid is fixed a priori, see [<a href="../../references/#laverny2020">20</a>] for a construction with an adaptive grid.</p><p>Convergence results for this kind of copulas can be found in [<a href="../../references/#durante2015">19</a>], with a slightly different parametrization. </p><div class="admonition is-info"><header class="admonition-header">Not implemeted yet!</header><div class="admonition-body"><p>Do not hesitate to come talk on <a href="https://github.com/lrnv/Copulas.jl">our github</a> !</p></div></div><div class="citation noncanonical"><dl><dt>[13]</dt><dd><div>P. Deheuvels. <em>La Fonction de Dépendance Empirique et Ses Propriétés. Académie Royale de Belgique</em>. Bulletin de la Classe des Sciences <strong>65</strong>, 274–292 (1979).</div></dd><dt>[14]</dt><dd><div>J. Segers, M. Sibuya and H. Tsukahara. <em>The Empirical Beta Copula</em>. Journal of Multivariate Analysis <strong>155</strong>, 35–51 (2017).</div></dd><dt>[15]</dt><dd><div>A. Cuberos, E. Masiello and V. Maume-Deschamps. <em>Copulas Checker-Type Approximations: Application to Quantiles Estimation of Sums of Dependent Random Variables</em>. Communications in Statistics - Theory and Methods, 1–19 (2019).</div></dd><dt>[16]</dt><dd><div>P. Mikusiński and M. D. Taylor. <em>Some Approximations of N-Copulas</em>. Metrika <strong>72</strong>, 385–414 (2010).</div></dd><dt>[17]</dt><dd><div>F. Durante, E. Foscolo, J. A. Rodríguez-Lallena and M. Úbeda-Flores. <em>A Method for Constructing Higher-Dimensional Copulas</em>. Statistics <strong>46</strong>, 387–404 (2012).</div></dd><dt>[18]</dt><dd><div>F. Durante, J. Fernández Sánchez and C. Sempi. <em>Multivariate Patchwork Copulas: A Unified Approach with Applications to Partial Comonotonicity</em>. Insurance: Mathematics and Economics <strong>53</strong>, 897–905 (2013).</div></dd><dt>[19]</dt><dd><div>F. Durante, J. Fernández-Sánchez, J. J. Quesada-Molina and M. Úbeda-Flores. <em>Convergence Results for Patchwork Copulas</em>. European Journal of Operational Research <strong>247</strong>, 525–531 (2015).</div></dd><dt>[20]</dt><dd><div>O. Laverny. <em>Empirical and Non-Parametric Copula Models with the Cort R Package</em>. Journal of Open Source Software <strong>5</strong>, 2653 (2020).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../transformations/">« Transformed Copulas</a><a class="docs-footer-nextpage" href="../available_models/">Available Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Thursday 30 November 2023 18:45">Thursday 30 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
