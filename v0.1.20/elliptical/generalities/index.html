<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Discussion · Copulas.jl</title><meta name="title" content="General Discussion · Copulas.jl"/><meta property="og:title" content="General Discussion · Copulas.jl"/><meta property="twitter:title" content="General Discussion · Copulas.jl"/><meta name="description" content="Documentation for Copulas.jl."/><meta property="og:description" content="Documentation for Copulas.jl."/><meta property="twitter:description" content="Documentation for Copulas.jl."/><meta property="og:url" content="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><meta property="twitter:url" content="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><link rel="canonical" href="https://lrnv.github.io/Copulas.jl/elliptical/generalities/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Copulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Copulas.jl package</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../sklar/">Sklar&#39;s Distributions</a></li><li><span class="tocitem">Elliptical Copulas</span><ul><li class="is-active"><a class="tocitem" href>General Discussion</a><ul class="internal"><li><a class="tocitem" href="#Elliptical-random-vectors"><span>Elliptical random vectors</span></a></li><li><a class="tocitem" href="#Elliptical-copulas"><span>Elliptical copulas</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../available_models/">Available models</a></li></ul></li><li><span class="tocitem">Archimedean Copulas</span><ul><li><a class="tocitem" href="../../archimedean/generalities/">General Discussion</a></li><li><a class="tocitem" href="../../archimedean/available_models/">Available Models</a></li></ul></li><li><a class="tocitem" href="../../Liouville/">Liouville Copulas</a></li><li><a class="tocitem" href="../../miscellaneous/">Other Copulas</a></li><li><a class="tocitem" href="../../transformations/">Transformed Copulas</a></li><li><span class="tocitem">Empirical Copulas</span><ul><li><a class="tocitem" href="../../empirical/generalities/">General Discussion</a></li><li><a class="tocitem" href="../../empirical/available_models/">Available Models</a></li></ul></li><li><a class="tocitem" href="../../dependence_measures/">Dependence measures</a></li><li><span class="tocitem">Exemples</span><ul><li><a class="tocitem" href="../../exemples/fitting_sklar/">Fitting compound distributions</a></li><li><a class="tocitem" href="../../exemples/turing/">Bayesian inference with Turing.jl</a></li></ul></li><li><a class="tocitem" href="../../dev_roadmap/">Dev Roadmap</a></li><li><a class="tocitem" href="../../idx/">Package Index</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Elliptical Copulas</a></li><li class="is-active"><a href>General Discussion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Discussion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lrnv/Copulas.jl/blob/main/docs/src/elliptical/generalities.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="elliptical_copulas_header"><a class="docs-heading-anchor" href="#elliptical_copulas_header">General Discussion</a><a id="elliptical_copulas_header-1"></a><a class="docs-heading-anchor-permalink" href="#elliptical_copulas_header" title="Permalink"></a></h1><h2 id="Elliptical-random-vectors"><a class="docs-heading-anchor" href="#Elliptical-random-vectors">Elliptical random vectors</a><a id="Elliptical-random-vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Elliptical-random-vectors" title="Permalink"></a></h2><p>The easiest families of copulas are the one derived from known families of random vectors, and the first presented one is, generally, the Elliptical family. </p><blockquote><p><strong>Definition (Spherical and elliptical random vectors):</strong> A random vector <span>$\bm X$</span> is said to be spherical if for all orthogonal matrix <span>$\bm A \in O_d(\mathbb R)$</span>, <span>$\bm A\bm X \sim \bm X$</span>. </p><p>For every matrix <span>$\bm B$</span> and vector <span>$\bm c$</span>, the random vector <span>$\bm B \bm X + \bm c$</span> is then said to be elliptical.</p></blockquote><p>Spherical random vectors have several interesting properties. First, the shape of the distribution must be the same in every direction since it is stable by rotations. Moreover, their characteristic functions (c.f.) only depend on the norm of their arguments. Indeed, for any <span>$\bm A \in O_d(\mathbb R)$</span>, </p><p class="math-container">\[\phi(\bm t) = \mathbb E\left(e^{\langle \bm t, \bm X \rangle}\right)= \mathbb E\left(e^{\langle \bm t, \bm A\bm X \rangle}\right) = \mathbb E\left(e^{\langle \bm A\bm t, \bm X \rangle}\right) = \phi(\bm A\bm t).\]</p><p>We can therefore express this characteristic function as <span>$\phi(\bm t) = \psi(\lVert \bm t \rVert_2^2)$</span>, where <span>$\psi$</span> is a function that characterizes the spherical family, called the <em>generator</em> of the family. Any characteristic function that can be expressed as a function of the norm of its argument is the characteristic function of a spherical random vector, since <span>$\lVert \bm A \bm t \rVert_2 = \lVert \bm t \rVert_2$</span> for any orthogonal matrix <span>$\bm A$</span>. </p><p>This class contains the (multivariate) Normal and Student distributions, and it is easy to construct others if needed. This is a generalization of the family of Gaussian random vectors, and they benefit from several nice properties of the former, among which, particularly interesting, the stability by convolution. Indeed, convolutions correspond to product of characteristic functions, and</p><p class="math-container">\[\phi(\bm t) = \prod_{i=1}^n \phi_i(\bm t) = \prod_{i=1}^n \psi_i(\lVert \bm t \rVert_2^2) = \psi(\lVert \bm t \rVert_2^2),\]</p><p>which is still a function of only the norm of <span>$\bm t$</span>. To fix ideas, for Gaussian random vectors, <span>$\psi(t) = e^{-\frac{t^2}{2}}$</span>.</p><h2 id="Elliptical-copulas"><a class="docs-heading-anchor" href="#Elliptical-copulas">Elliptical copulas</a><a id="Elliptical-copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Elliptical-copulas" title="Permalink"></a></h2><p>Elliptical copulas are simply copulas of elliptical distributions. This simplicity of definition is paid for in the expression of the copulas itself: the obtained function has usually no better expression than </p><p class="math-container">\[C = F \circ (F_1^{-1},...,F_d^{-1}),\]</p><p>where <span>$F_i^{-1}$</span> denotes the almost-inverse of <span>$F_i$</span>, that is: </p><p class="math-container">\[\forall u \in [0,1],\;F_i^{-1}(u) = \inf\left\{x :\, F_i(x) \ge u\right\},\]</p><p>and <span>$F_i$</span> is usually hard to express from the elliptical assumptions.</p><p>Moreover, the form of dependence structures that can be reached inside this class is restricted. The elliptical copulas are parametrized by the corresponding univariate spherical generator and a correlation matrix, which is a very simple structure. See also [<a href="../../references/#frahm2003">28</a>–<a href="../../references/#cote2019">30</a>] for details on these copulas. </p><p>On the other hand, there exist performant estimators of high-dimensional covariance matrices, and a large theory is built on the elliptical assumption of high dimensional random vectors, see e.g., [<a href="../../references/#elidan2013">31</a>–<a href="../../references/#muller2019">33</a>] among others. See also [<a href="../../references/#derumigny2022">34</a>] for a recent work on nonparametric estimation of the underlying univariate spherical distribution. </p><div class="admonition is-info"><header class="admonition-header">Discrepancy with the code</header><div class="admonition-body"><p>If the exposition we just did on characteristic functions of Elliptical random vectors is fundamental to the definition of elliptical copulas, the package does not use this at all to function, and rather rely on the existence of multivariate and corresponding univariate families of distributions in <code>Distributions.jl</code>. </p></div></div><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Copulas.EllipticalCopula" href="#Copulas.EllipticalCopula"><code>Copulas.EllipticalCopula</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EllipticalCopula{d,MT}</code></pre><p>This is an abstract type. It implements an interface for all Elliptical copulas. We construct internally elliptical copulas using the sklar&#39;s theorem, by considering the copula <span>$C$</span> to be defined as : </p><p class="math-container">\[C = F `\circ (F_1^{-1},...,F_d^{-1}),\]</p><p>where <span>$F$</span> and <span>$F_1,...,F_d$</span> are respectively the multivariate distribution function of some elliptical random vector and the univaraite distribution function of its marginals.  For a type <code>MyCop &lt;: EllipitcalCopula</code>, it is necessary to implement the following methods: </p><ul><li><code>N(::Type{MyCOp})</code>, returning the constructor of the elliptical random vector from its corelation matrix. For example, <code>N(GaussianCopula)</code> simply returns <code>MvNormal</code> from <code>Distributions.jl</code>.</li><li><code>U(::Type{MyCOp})</code>, returning the constructor for the univariate marginal, usually in standardized form. For exemple, <code>U(GaussianCopula)</code> returns <code>Normal</code> from <code>Distributions.jl</code>.</li></ul><p>From these two functions, the abstract type provide a fully functional copula. </p><p><strong>Details</strong></p><p>Recall the definition of spherical random vectors: </p><blockquote><p><strong>Definition (Spherical and elliptical random vectors):</strong> A random vector <span>$\bm X$</span> is said to be spherical if for all orthogonal matrix <span>$\bm A \in O_d(\mathbb R)$</span>, <span>$\bm A\bm X \sim \bm X$</span>. </p><p>For every matrix <span>$\bm B$</span> and vector <span>$\bm c$</span>, the random vector <span>$\bm B \bm X + \bm c$</span> is then said to be elliptical.</p></blockquote><p>Recall that spherical random vectors are random vectors which characteristic functions (c.f.) only depend on the norm of their arguments. Indeed, for any <span>$\bm A \in O_d(\mathbb R)$</span>, </p><p class="math-container">\[\phi(\bm t) = \mathbb E\left(e^{\langle \bm t, \bm X \rangle}\right)= \mathbb E\left(e^{\langle \bm t, \bm A\bm X \rangle}\right) = \mathbb E\left(e^{\langle \bm A\bm t, \bm X \rangle}\right) = \phi(\bm A\bm t).\]</p><p>We can therefore express this characteristic function as <span>$\phi(\bm t) = \psi(\lVert \bm t \rVert_2^2)$</span>, where <span>$\psi$</span> is a function that characterizes the spherical family, called the <em>generator</em> of the family. Any characteristic function that can be expressed as a function of the norm of its argument is the characteristic function of a spherical random vector, since <span>$\lVert \bm A \bm t \rVert_2 = \lVert \bm t \rVert_2$</span> for any orthogonal matrix <span>$\bm A$</span>. </p><p>However, note that this is not how the underlying code is working, we do not check for validity of the proposed generator (we dont even use it)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lrnv/Copulas.jl/blob/32d1ac56383f9da386f05d3992c6fe518e447125/src/EllipticalCopula.jl#L1-L34">source</a></section></article><div class="citation noncanonical"><dl><dt>[28]</dt><dd><div>G. Frahm, M. Junker and A. Szimayer. <em>Elliptical Copulas: Applicability and Limitations</em>. Statistics &amp; Probability Letters <strong>63</strong>, 275–286 (2003).</div></dd><dt>[29]</dt><dd><div>E. Gómez, M. A. Gómez-villegas and J. M. Marín. <em>A Survey on Continuous Elliptical Vector Distributions</em>. Revista Matemática Complutense <strong>16</strong>, 345–361 (2003).</div></dd><dt>[30]</dt><dd><div>M.-P. Côté and C. Genest. <em>Dependence in a Background Risk Model</em>. Journal of Multivariate Analysis <strong>172</strong>, 28–46 (2019).</div></dd><dt>[31]</dt><dd><div>G. Elidan. <em>Copulas in Machine Learning</em>. In: <em>Copulae in Mathematical and Quantitative Finance</em>, Vol. 213, edited by P. Jaworski, F. Durante and W. K. Härdle (Springer Berlin Heidelberg, Berlin, Heidelberg, 2013); pp. 39–60.</div></dd><dt>[32]</dt><dd><div>J. Friedman, T. Hastie and R. Tibshirani. <em>Applications of the Lasso and Grouped Lasso to the Estimation of Sparse Graphical Models</em> (Technical report, Stanford University, 2010).</div></dd><dt>[33]</dt><dd><div>D. Müller and C. Czado. <em>Dependence Modelling in Ultra High Dimensions with Vine Copulas and the Graphical Lasso</em>. Computational Statistics &amp; Data Analysis <strong>137</strong>, 211–232 (2019).</div></dd><dt>[34]</dt><dd><div>A. Derumigny and J.-D. Fermanian. <em>Identifiability and Estimation of Meta-Elliptical Copula Generators</em>. Journal of Multivariate Analysis, 104962 (2022).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../sklar/">« Sklar&#39;s Distributions</a><a class="docs-footer-nextpage" href="../available_models/">Available models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Thursday 30 November 2023 18:45">Thursday 30 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
